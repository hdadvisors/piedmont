<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jonathan Knopf (jonathan@hdadvisors.net)">
<meta name="dcterms.date" content="2023-01-30">

<title>Piedmont Housing Alliance Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="piedmont_files/libs/clipboard/clipboard.min.js"></script>
<script src="piedmont_files/libs/quarto-html/quarto.js"></script>
<script src="piedmont_files/libs/quarto-html/popper.min.js"></script>
<script src="piedmont_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="piedmont_files/libs/quarto-html/anchor.min.js"></script>
<link href="piedmont_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="piedmont_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="piedmont_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="piedmont_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="piedmont_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="piedmont_files/libs/core-js-2.5.3/shim.min.js"></script>
<script src="piedmont_files/libs/react-17.0.0/react.min.js"></script>
<script src="piedmont_files/libs/react-17.0.0/react-dom.min.js"></script>
<script src="piedmont_files/libs/reactwidget-1.0.0/react-tools.js"></script>
<script src="piedmont_files/libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<link href="piedmont_files/libs/reactable-0.4.3/reactable.css" rel="stylesheet">
<script src="piedmont_files/libs/reactable-binding-0.4.3/reactable.js"></script>
<script src="piedmont_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="piedmont_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="piedmont_files/libs/jquery-1.12.4/jquery.min.js"></script>
<link href="piedmont_files/libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="piedmont_files/libs/leaflet-1.3.1/leaflet.js"></script>
<link href="piedmont_files/libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="piedmont_files/libs/proj4-2.6.2/proj4.min.js"></script>
<script src="piedmont_files/libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="piedmont_files/libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="piedmont_files/libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="piedmont_files/libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="piedmont_files/libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>
<link href="piedmont_files/libs/HomeButton-0.0.1/home-button.css" rel="stylesheet">
<script src="piedmont_files/libs/HomeButton-0.0.1/home-button.js"></script>
<script src="piedmont_files/libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="piedmont_files/libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="piedmont_files/libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet">
<link href="piedmont_files/libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#about" id="toc-about" class="nav-link active" data-scroll-target="#about"><span class="toc-section-number">1</span>  About</a>
  <ul class="collapse">
  <li><a href="#goals" id="toc-goals" class="nav-link" data-scroll-target="#goals"><span class="toc-section-number">1.1</span>  Goals</a></li>
  <li><a href="#guiding-questions" id="toc-guiding-questions" class="nav-link" data-scroll-target="#guiding-questions"><span class="toc-section-number">1.2</span>  Guiding questions</a></li>
  </ul></li>
  <li><a href="#data-assembly" id="toc-data-assembly" class="nav-link" data-scroll-target="#data-assembly"><span class="toc-section-number">2</span>  Data assembly</a>
  <ul class="collapse">
  <li><a href="#program-and-client-data" id="toc-program-and-client-data" class="nav-link" data-scroll-target="#program-and-client-data"><span class="toc-section-number">2.1</span>  Program and client data</a></li>
  <li><a href="#regional-and-neighborhood-profiles" id="toc-regional-and-neighborhood-profiles" class="nav-link" data-scroll-target="#regional-and-neighborhood-profiles"><span class="toc-section-number">2.2</span>  Regional and neighborhood profiles</a></li>
  <li><a href="#mortgage-applications-and-activity" id="toc-mortgage-applications-and-activity" class="nav-link" data-scroll-target="#mortgage-applications-and-activity"><span class="toc-section-number">2.3</span>  Mortgage applications and activity</a></li>
  <li><a href="#home-values" id="toc-home-values" class="nav-link" data-scroll-target="#home-values"><span class="toc-section-number">2.4</span>  Home values</a>
  <ul class="collapse">
  <li><a href="#real-estate-assessments" id="toc-real-estate-assessments" class="nav-link" data-scroll-target="#real-estate-assessments"><span class="toc-section-number">2.4.1</span>  Real estate assessments</a></li>
  <li><a href="#mls-sales" id="toc-mls-sales" class="nav-link" data-scroll-target="#mls-sales"><span class="toc-section-number">2.4.2</span>  MLS sales</a></li>
  </ul></li>
  <li><a href="#other-data" id="toc-other-data" class="nav-link" data-scroll-target="#other-data"><span class="toc-section-number">2.5</span>  Other data</a></li>
  </ul></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis"><span class="toc-section-number">3</span>  Analysis</a>
  <ul class="collapse">
  <li><a href="#clients-served-by-program" id="toc-clients-served-by-program" class="nav-link" data-scroll-target="#clients-served-by-program"><span class="toc-section-number">3.1</span>  Clients served by program</a></li>
  <li><a href="#profile-of-clients" id="toc-profile-of-clients" class="nav-link" data-scroll-target="#profile-of-clients"><span class="toc-section-number">3.2</span>  Profile of clients</a></li>
  <li><a href="#assistance-levels" id="toc-assistance-levels" class="nav-link" data-scroll-target="#assistance-levels"><span class="toc-section-number">3.3</span>  Assistance levels</a></li>
  <li><a href="#spatial-patterns" id="toc-spatial-patterns" class="nav-link" data-scroll-target="#spatial-patterns"><span class="toc-section-number">3.4</span>  Spatial patterns</a>
  <ul class="collapse">
  <li><a href="#client-origins" id="toc-client-origins" class="nav-link" data-scroll-target="#client-origins"><span class="toc-section-number">3.4.1</span>  Client origins</a></li>
  <li><a href="#client-destinations" id="toc-client-destinations" class="nav-link" data-scroll-target="#client-destinations"><span class="toc-section-number">3.4.2</span>  Client destinations</a></li>
  <li><a href="#client-moves" id="toc-client-moves" class="nav-link" data-scroll-target="#client-moves"><span class="toc-section-number">3.4.3</span>  Client moves</a></li>
  </ul></li>
  <li><a href="#housing-outcomes" id="toc-housing-outcomes" class="nav-link" data-scroll-target="#housing-outcomes"><span class="toc-section-number">3.5</span>  Housing outcomes</a></li>
  <li><a href="#home-equity" id="toc-home-equity" class="nav-link" data-scroll-target="#home-equity"><span class="toc-section-number">3.6</span>  Home equity</a></li>
  </ul></li>
  <li><a href="#takeaways" id="toc-takeaways" class="nav-link" data-scroll-target="#takeaways"><span class="toc-section-number">4</span>  Takeaways</a></li>
  <li><a href="#next-steps" id="toc-next-steps" class="nav-link" data-scroll-target="#next-steps"><span class="toc-section-number">5</span>  Next steps</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Piedmont Housing Alliance Data Analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jonathan Knopf (jonathan@hdadvisors.net) </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 30, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Setup code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data management and analysis tools</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidycensus)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Load spatial analysis tools</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidygeocoder)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tigris)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapview)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data visualization tools</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hdatools)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reactable)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(formattable)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Set defaults</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"~/repos/piedmont"</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>today <span class="ot">&lt;-</span> <span class="fu">Sys.Date</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout-caution callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Please note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This document is still under construction. It was last updated January 30, 2023 at 02:31 PM.</p>
</div>
</div>
<section id="about" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> About</h1>
<p>Piedmont Housing Alliance (PHA) is a 501(c)3 nonprofit organization that provides housing services to clients in the Charlottesville, Virginia region. In 2022, PHA received a Tier III Capacity Building Program Enhancement Grant from Virginia Housing to evaluate and improve their programs aimed at helping first-time homebuyers.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
How PHA helps first-time homebuyers
</div>
</div>
<div class="callout-body-container callout-body">
<p>PHA offers two programs to help buyers earning less than 80% of Area Median Income (AMI) purchase their first home.</p>
<ol type="1">
<li><p>The <strong>Down Payment Loan</strong> (DPL) program combines funding from several different sources to provide buyers with additional assistance to increase their total down payment and cover closing costs. This allows buyer to more easily afford homes at prices they would otherwise be unable to afford.</p></li>
<li><p>PHA administers the <strong>Sponsoring Partnerships &amp; Revitalizing Communities</strong> (SPARC) program, which lowers a buyer’s mortgage interest rate by 1.00%. SPARC funds are allocated by Virginia Housing and help buyers save thousands of dollars over the life of their loan.</p></li>
</ol>
</div>
</div>
<p>PHA seeks a deeper understanding of these two programs’ outcomes and impacts, particularly in terms of racial equity and wealth-building. This document was prepared by HDAdvisors to develop methods for evaluating the program using internal and external data.</p>
<section id="goals" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="goals"><span class="header-section-number">1.1</span> Goals</h2>
<p>The primary goal of this analysis is a preliminary evaluation of the DPL and SPARC programs’ current abilities to support buyers who are more likely to be at a systemic disadvantage because of unjust lending practices and other discriminatory efforts.</p>
<p>The secondary goal is to provide PHA staff with reproducible methods for collecting, preparing, and analyzing the data necessary for this evaluation. This will allow PHA to regularly track and monitor these programs without outside assistance.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Why this matters
</div>
</div>
<div class="callout-body-container callout-body">
<p>This analysis will be helpful for PHA in three important ways:</p>
<ol type="1">
<li>To proactively assess whether the program fulfills all applicable fair housing requirements,</li>
<li>To provide staff with a thorough understanding of program outcomes for stronger grant applications, and</li>
<li>To further PHA’s existing Diversity, Equity, and Inclusion (DEI) efforts.</li>
</ol>
</div>
</div>
</section>
<section id="guiding-questions" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="guiding-questions"><span class="header-section-number">1.2</span> Guiding questions</h2>
<p>The following questions help determine (1) what kind of data is needed, and (2) how that data should be analyzed.</p>
<ul>
<li>How do PHA’s clients vary by race, ethnicity, and income compared to the region as a whole?</li>
<li>Do the levels of assistance vary significantly by race, ethnicity, and income?</li>
<li>Are there noticeable migration patterns for clients purchasing their first home?</li>
<li>How do the homes purchased by clients compare to similar homes in that neighborhood?</li>
<li>How much home equity have past clients gained? How similar are these gains across race, ethnicity, and neighborhoods?</li>
</ul>
</section>
</section>
<section id="data-assembly" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Data assembly</h1>
<p>This section outlines each metric necessary for analysis, along with methods for collecting and cleaning the appropriate data.</p>
<section id="program-and-client-data" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="program-and-client-data"><span class="header-section-number">2.1</span> Program and client data</h2>
<p>PHA provided data on DPL and SPARC clients from FY 2018 through FY 2023.</p>
<p>This data includes attributes about each client household, including:</p>
<ul>
<li>Total annual income</li>
<li>Area median income (AMI)</li>
<li>Race and ethnicity (optional)</li>
<li>Number of persons</li>
<li>Street address (at time of application)</li>
</ul>
<p>It also includes DPL-specific program data, including:</p>
<ul>
<li>Number of loans provided</li>
<li>Total amount of DPL assistance</li>
<li>Funding sources used for each loan</li>
<li>Source(s) and amount of non-DPL assistance</li>
</ul>
<p>Information on the homes purchased by clients include:</p>
<ul>
<li>Street address</li>
<li>Sales price</li>
<li>Appraised value</li>
<li>Closing costs and other prepaids</li>
</ul>
<p>Information about clients’ mortgages are also provided:</p>
<ul>
<li>Lending institution</li>
<li>Mortgage product</li>
<li>Mortgage amount</li>
<li>Interest rate</li>
<li>Original interest rate (SPARC only)</li>
<li>Closing date</li>
</ul>
<p>The full dataset includes multiple other fields that are not necessary or relevant to this analysis.</p>
<p><strong>Step 1: Import data</strong></p>
<div class="cell">
<details>
<summary>Client data import</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import list of DPL clients and clean column names</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>clients_dpl_raw <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/raw/clients.xlsx"</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">sheet =</span> <span class="st">"Down Payment Loan"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Import list of SPARC clients and clean column names</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>clients_sparc_raw <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/raw/clients.xlsx"</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">sheet =</span> <span class="st">"SPARC"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Step 2: Clean up and fix data</strong></p>
<div class="cell">
<details>
<summary>DPL client data prep</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean up DPL data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>clients_dpl <span class="ot">&lt;-</span> clients_dpl_raw <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Drop rows that do not have client records</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(contract_date) <span class="sc">|&gt;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove columns with personal information or unnecessary data</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(fha_case_number, ami_approval_date, client_intake_date,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>            client_last_name, client_first_name, counselor,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>            service_type, client_employer, employer_msa,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>            property_msa, status, loan_officer, client_msa,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>            client_email_address, phone_number</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>            )) <span class="sc">|&gt;</span> </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rename certain columns to more helpful descriptions</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">mortgage_product =</span> x1st_mortgage_product,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">mortgage_amount =</span> x1st_mortgage_amount,</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">pha_loans_n =</span> number_of_pha_loans,</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">pha_loans_amount =</span> of_pha_loans,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">pha_loan_source =</span> source_of_pha_loan</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">|&gt;</span> </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create new unique DPL client ID column</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id_dpl =</span> <span class="fu">str_c</span>(<span class="st">"DPL"</span>, <span class="fu">str_pad</span>(<span class="fu">row_number</span>(), <span class="dv">3</span>, <span class="at">pad =</span> <span class="st">"0"</span>)),</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clean up original client_number column</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">client_number =</span> <span class="fu">str_remove_all</span>(client_number, <span class="st">"</span><span class="sc">\\</span><span class="st">.0"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Change "Unknown" values to NA in appraised_value</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">appraised_value =</span> <span class="fu">as.numeric</span>(<span class="fu">na_if</span>(appraised_value, <span class="st">"Unknown"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clean up lending_institution names</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lending_institution =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(lending_institution, <span class="st">"Coast"</span>) <span class="sc">~</span> <span class="st">"Atlantic Coast Mortgage"</span>,</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(lending_institution, <span class="st">"Fulton"</span>) <span class="sc">~</span> <span class="st">"Fulton Mortgage"</span>,</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(lending_institution, <span class="st">"Charlottesville"</span>) <span class="sc">~</span> <span class="st">"Habitat for Humanity of Greater Charlottesville"</span>,</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(lending_institution, <span class="fu">regex</span>(<span class="st">"first"</span>, <span class="at">ignore_case =</span> T)) <span class="sc">~</span> <span class="st">"Towne First Mortgage"</span>,</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(lending_institution, <span class="st">"USDA"</span>) <span class="sc">~</span> <span class="st">"USDA"</span>,</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(lending_institution, <span class="st">"Waterstone"</span>) <span class="sc">~</span> <span class="st">"Waterstone Mortgage Corporation"</span>,</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    lending_institution <span class="sc">==</span> <span class="st">"Towne Bank Mortgage"</span> <span class="sc">~</span> <span class="st">"TowneBank Mortgage"</span>,</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> lending_institution</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clean up mortgage_product names</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mortgage_product =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(mortgage_product, <span class="st">"502|USDA|RHS"</span>) <span class="sc">~</span> <span class="st">"502 Direct Loan"</span>,</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    mortgage_product <span class="sc">==</span> <span class="st">"Coventional"</span> <span class="sc">~</span> <span class="st">"Conventional"</span>,</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(mortgage_product, <span class="st">"VHDA FHA|VHDA - HFA"</span>) <span class="sc">~</span> <span class="st">"VHDA - FHA"</span>,</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> mortgage_product</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Change '$-' values in other_assistance_amount to NA</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">other_assistance_amount =</span> <span class="fu">as.numeric</span>(<span class="fu">na_if</span>(other_assistance_amount, <span class="st">"$-"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create column for single or multiple race; clean up race names</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">multirace =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(race, <span class="st">"Multi"</span>) <span class="sc">~</span> <span class="st">"Multiple"</span>,</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Single"</span>),</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">.before =</span> race) <span class="sc">|&gt;</span> </span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(race, <span class="st">"and White"</span>) <span class="sc">~</span> <span class="st">"Black and White"</span>,</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(race, <span class="st">"Other"</span>) <span class="sc">~</span> <span class="st">"Other races"</span>,</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(race, <span class="st">"Asian"</span>) <span class="sc">~</span> <span class="st">"Asian"</span>,</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(race, <span class="st">"Single Race - Black"</span>) <span class="sc">~</span> <span class="st">"Black"</span>,</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"White"</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simplify rural_area_status and english_proficiency columns</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rural_area_status =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(rural_area_status, <span class="st">"lives"</span>) <span class="sc">~</span> <span class="st">"Rural"</span>,</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Not rural"</span></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">english_proficiency =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(english_proficiency, <span class="st">"is not"</span>) <span class="sc">~</span> <span class="st">"Not proficient"</span>,</span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Proficient"</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>SPARC client data prep</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean up SPARC data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>clients_sparc <span class="ot">&lt;-</span> clients_sparc_raw <span class="sc">|&gt;</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove columns with personal information or unnecessary data</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(last_name, first_name, client,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>            lenders_name, x20)) <span class="sc">|&gt;</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rename certain columns to match DPL data</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sale_price =</span> sales_price,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">mortgage_amount =</span> base_loan_amount,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">household_annual_income =</span> borrower_s_income,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">household_size =</span> number_in_hh,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">locality =</span> msa,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">mortgage_product =</span> loan_product,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">lending_institution =</span> lending_company</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">|&gt;</span> </span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Change client_number column to string</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">client_number =</span> <span class="fu">as.character</span>(client_number)) <span class="sc">|&gt;</span> </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create new unique SPARC client ID column</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id_sparc =</span> <span class="fu">str_c</span>(<span class="st">"SPC"</span>, <span class="fu">str_pad</span>(<span class="fu">row_number</span>(), <span class="dv">3</span>, <span class="at">pad =</span> <span class="st">"0"</span>)),</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fix interest_rate values</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">interest_rate =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    interest_rate <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">~</span> interest_rate<span class="sc">/</span><span class="dv">100</span>,</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> interest_rate</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create mortgage_notes column for specific loan info</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mortgage_notes =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(mortgage_product, <span class="st">"No MI"</span>) <span class="sc">~</span> <span class="st">"No mortgage insurance"</span>,</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(mortgage_product, <span class="st">"Reduced"</span>) <span class="sc">~</span> <span class="st">"Reduced mortgage insurance"</span>,</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(mortgage_product, <span class="st">"Second Plus"</span>) <span class="sc">~</span> <span class="st">"Second Plus"</span>,</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>),</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">.after =</span> mortgage_product</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clean up mortgage_product names to match DPL data</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mortgage_product =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(mortgage_product, <span class="fu">regex</span>(<span class="st">"Conventional"</span>, <span class="at">ignore_case =</span> T)) <span class="sc">~</span> <span class="st">"Conventional"</span>,</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(mortgage_product, <span class="fu">regex</span>(<span class="st">"RHS"</span>, <span class="at">ignore_case =</span> T)) <span class="sc">~</span> <span class="st">"502 Direct Loan"</span>,</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(mortgage_product, <span class="fu">regex</span>(<span class="st">"FHA"</span>, <span class="at">ignore_case =</span> T)) <span class="sc">~</span> <span class="st">"FHA"</span>,</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(mortgage_product) <span class="sc">~</span> <span class="st">"Unknown"</span>,</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> mortgage_product</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clean up lending_institution names to match DPL data</span></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lending_institution =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(lending_institution, <span class="st">"C&amp;F"</span>) <span class="sc">~</span> <span class="st">"C&amp;F Mortgage Corporation"</span>,</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(lending_institution, <span class="st">"Waterstone"</span>) <span class="sc">~</span> <span class="st">"Waterstone Mortgage Corporation"</span>,</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(lending_institution) <span class="sc">~</span> <span class="st">"Unknown"</span>,</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> lending_institution</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clean up yes/no columns</span></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">received_cd =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(received_cd, <span class="st">"YES|Yes|yes"</span>) <span class="sc">~</span> <span class="st">"Yes"</span>,</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>    received_cd <span class="sc">==</span> <span class="st">"no"</span> <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>    received_cd <span class="sc">==</span> <span class="st">"N/A"</span> <span class="sc">~</span> <span class="cn">NA_character_</span>,</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">in_ors =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(in_ors, <span class="st">"No -"</span>) <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> in_ors</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Step 3: Join DPL and SPARC client data</strong></p>
<p>Some clients use both the DPL and SPARC programs to purchase their home. For now, these clients were identified by manually cross-referencing names and other fields. To join the data, the DPL <code>client_number</code> values were assigned to the respective client records in the SPARC data.</p>
<p>In the future, PHA should maintain a single client dataset that can differentiate between DPL-only, SPARC-only, and “double-dipping” clients. Specific recommendations will be detailed at the end of this document.</p>
<div class="cell">
<details>
<summary>Client data join</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create full join using client_number</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>clients_all <span class="ot">&lt;-</span> clients_dpl <span class="sc">|&gt;</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(clients_sparc, <span class="at">by =</span> <span class="st">"client_number"</span>, <span class="at">na_matches =</span> <span class="st">"never"</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">"_dpl"</span>, <span class="st">"_spc"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reorder columns to place duplicate fields together</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">46</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">47</span>, <span class="dv">5</span>, <span class="dv">52</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">53</span>, <span class="dv">8</span>, <span class="dv">9</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>         <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">50</span>, <span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">59</span>, <span class="dv">18</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>         <span class="dv">55</span>, <span class="dv">19</span>, <span class="dv">51</span>, <span class="dv">20</span>, <span class="dv">49</span>, <span class="dv">48</span>, <span class="dv">50</span>, <span class="dv">21</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">24</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>         <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">27</span>, <span class="dv">28</span>, <span class="dv">29</span>, <span class="dv">30</span>, <span class="dv">31</span>, <span class="dv">32</span>, <span class="dv">33</span>, <span class="dv">34</span>, <span class="dv">35</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>         <span class="dv">36</span>, <span class="dv">37</span>, <span class="dv">38</span>, <span class="dv">39</span>, <span class="dv">40</span>, <span class="dv">41</span>, <span class="dv">42</span>, <span class="dv">43</span>, <span class="dv">44</span>, <span class="dv">45</span>, <span class="dv">54</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>         <span class="dv">56</span>, <span class="dv">57</span>, <span class="dv">60</span>, <span class="dv">61</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">|&gt;</span> </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create column to show whether client uses one or both programs</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">program =</span> <span class="fu">case_when</span>(</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span><span class="fu">is.na</span>(id_dpl) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(id_sparc) <span class="sc">~</span> <span class="st">"Both"</span>,</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span><span class="fu">is.na</span>(id_dpl) <span class="sc">&amp;</span> <span class="fu">is.na</span>(id_sparc) <span class="sc">~</span> <span class="st">"DPL"</span>,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"SPARC"</span>),</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create universal client ID column</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id_pha =</span> <span class="fu">str_c</span>(<span class="st">"PHA"</span>, <span class="fu">str_pad</span>(<span class="fu">row_number</span>(), <span class="dv">3</span>, <span class="at">pad =</span> <span class="st">"0"</span>)),</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Step 4: View data</strong></p>
<p>Cleaned and joined client data are shown in the table below.</p>
<div class="cell">
<details>
<summary>Generate table</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(clients_all,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">defaultPageSize =</span> <span class="dv">5</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">defaultColDef =</span> <span class="fu">colDef</span>(<span class="at">minWidth =</span> <span class="dv">150</span>),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">compact =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">wrap =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="reactable html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-b19a93dd67c30429c137" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b19a93dd67c30429c137">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"id_pha":["PHA001","PHA002","PHA003","PHA004","PHA005","PHA006","PHA007","PHA008","PHA009","PHA010","PHA011","PHA012","PHA013","PHA014","PHA015","PHA016","PHA017","PHA018","PHA019","PHA020","PHA021","PHA022","PHA023","PHA024","PHA025","PHA026","PHA027","PHA028","PHA029","PHA030","PHA031","PHA032","PHA033","PHA034","PHA035","PHA036","PHA037","PHA038","PHA039","PHA040","PHA041","PHA042","PHA043","PHA044","PHA045","PHA046","PHA047","PHA048","PHA049","PHA050","PHA051","PHA052","PHA053","PHA054","PHA055","PHA056","PHA057","PHA058","PHA059","PHA060","PHA061","PHA062","PHA063","PHA064","PHA065","PHA066","PHA067","PHA068","PHA069","PHA070","PHA071","PHA072","PHA073","PHA074","PHA075","PHA076","PHA077","PHA078","PHA079","PHA080","PHA081","PHA082","PHA083","PHA084","PHA085","PHA086","PHA087","PHA088","PHA089","PHA090","PHA091","PHA092","PHA093","PHA094","PHA095","PHA096","PHA097","PHA098","PHA099","PHA100","PHA101","PHA102","PHA103","PHA104","PHA105","PHA106","PHA107","PHA108","PHA109","PHA110","PHA111","PHA112","PHA113","PHA114","PHA115","PHA116","PHA117","PHA118","PHA119","PHA120","PHA121","PHA122","PHA123","PHA124","PHA125","PHA126","PHA127","PHA128","PHA129","PHA130","PHA131"],"program":["Both","DPL","DPL","Both","DPL","DPL","Both","Both","Both","Both","DPL","Both","Both","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","DPL","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC","SPARC"],"client_number":["4305081","4658207","4650788","4721465","4762987","4678353","4174728","4818114","4521883","3110090","4537406","4344979","4563447","4545129","4492259","4597563","4156078","4137443","4429823","4198590","4467690","4166861","4419275","4284472","4467690","3998379","4267141","Habitat","3875759","Habitat","4023880","4051871",null,null,"4132721","3900509","4002970","3401712","3446690","3582550","3672178","3798316","2251384","3818559",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"id_dpl":["DPL001","DPL002","DPL003","DPL004","DPL005","DPL006","DPL007","DPL008","DPL009","DPL010","DPL011","DPL012","DPL013","DPL014","DPL015","DPL016","DPL017","DPL018","DPL019","DPL020","DPL021","DPL022","DPL023","DPL024","DPL025","DPL026","DPL027","DPL028","DPL029","DPL030","DPL031","DPL032","DPL033","DPL034","DPL035","DPL036","DPL037","DPL038","DPL039","DPL040","DPL041","DPL042","DPL043","DPL044",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"id_sparc":["SPC002",null,null,"SPC022",null,null,"SPC005","SPC007","SPC023","SPC012",null,"SPC076","SPC074",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"SPC001","SPC003","SPC004","SPC006","SPC008","SPC009","SPC010","SPC011","SPC013","SPC014","SPC015","SPC016","SPC017","SPC018","SPC019","SPC020","SPC021","SPC024","SPC025","SPC026","SPC027","SPC028","SPC029","SPC030","SPC031","SPC032","SPC033","SPC034","SPC035","SPC036","SPC037","SPC038","SPC039","SPC040","SPC041","SPC042","SPC043","SPC044","SPC045","SPC046","SPC047","SPC048","SPC049","SPC050","SPC051","SPC052","SPC053","SPC054","SPC055","SPC056","SPC057","SPC058","SPC059","SPC060","SPC061","SPC062","SPC063","SPC064","SPC065","SPC066","SPC067","SPC068","SPC069","SPC070","SPC071","SPC072","SPC073","SPC075","SPC077","SPC078","SPC079","SPC080","SPC081","SPC082","SPC083","SPC084","SPC085","SPC086","SPC087","SPC088","SPC089","SPC090","SPC091","SPC092","SPC093","SPC094","SPC095"],"contract_date":["2022-05-24T00:00:00Z","2022-06-25T00:00:00Z","2021-07-21T00:00:00Z","2021-06-28T00:00:00Z","2021-06-05T00:00:00Z","2021-07-04T00:00:00Z","2021-08-31T00:00:00Z","2021-10-12T00:00:00Z","2020-10-29T00:00:00Z","2021-12-17T00:00:00Z","2020-06-01T00:00:00Z","2020-06-29T00:00:00Z","2020-08-18T00:00:00Z","2020-07-01T00:00:00Z","2020-10-07T00:00:00Z","2020-06-09T00:00:00Z","2019-12-16T00:00:00Z","2019-11-13T00:00:00Z","2019-12-02T00:00:00Z","2019-11-06T00:00:00Z","2019-07-26T00:00:00Z","2019-07-26T00:00:00Z","2019-12-05T00:00:00Z","2019-07-23T00:00:00Z","2020-01-31T00:00:00Z","2020-03-27T00:00:00Z","2020-04-22T00:00:00Z","2018-04-30T00:00:00Z","2018-06-27T00:00:00Z","2018-07-11T00:00:00Z","2018-09-27T00:00:00Z","2018-11-28T00:00:00Z","2018-12-21T00:00:00Z","2019-03-18T00:00:00Z","2019-03-27T00:00:00Z","2019-03-20T00:00:00Z","2019-05-15T00:00:00Z","2017-04-04T00:00:00Z","2017-06-29T00:00:00Z","2017-05-09T00:00:00Z","2018-07-11T00:00:00Z","2017-11-04T00:00:00Z","2018-02-22T00:00:00Z","2018-03-05T00:00:00Z",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"close_date_dpl":["2022-07-26T00:00:00Z","2022-08-02T00:00:00Z","2021-08-21T00:00:00Z","2021-08-21T00:00:00Z","2021-07-27T00:00:00Z","2021-08-23T00:00:00Z","2021-10-13T00:00:00Z","2021-12-14T00:00:00Z","2021-09-23T00:00:00Z","2022-02-28T00:00:00Z","2020-07-15T00:00:00Z","2020-08-21T00:00:00Z","2020-10-09T00:00:00Z","2020-12-15T00:00:00Z","2020-12-15T00:00:00Z","2020-12-29T00:00:00Z","2019-12-16T00:00:00Z","2020-01-02T00:00:00Z","2020-01-20T00:00:00Z","2020-01-28T00:00:00Z","2020-02-14T00:00:00Z","2020-02-18T00:00:00Z","2020-03-06T00:00:00Z","2020-03-06T00:00:00Z","2020-03-27T00:00:00Z","2020-05-28T00:00:00Z","2020-06-09T00:00:00Z","2018-07-18T00:00:00Z","2018-07-30T00:00:00Z","2018-09-10T00:00:00Z","2018-10-30T00:00:00Z","2018-12-27T00:00:00Z","2019-01-24T00:00:00Z","2019-04-30T00:00:00Z","2019-05-20T00:00:00Z","2019-06-05T00:00:00Z","2019-06-28T00:00:00Z","2017-07-13T00:00:00Z","2017-08-18T00:00:00Z","2017-08-24T00:00:00Z","2017-09-08T00:00:00Z","2017-12-05T00:00:00Z","2018-04-05T00:00:00Z","2018-04-26T00:00:00Z",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"close_date_spc":["2022-07-27T00:00:00Z",null,null,"2021-08-27T00:00:00Z",null,null,"2021-10-11T00:00:00Z","2021-12-15T00:00:00Z","2021-09-23T00:00:00Z","2022-02-14T00:00:00Z",null,"2020-08-14T00:00:00Z","2020-09-30T00:00:00Z",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2022-07-26T00:00:00Z","2022-08-30T00:00:00Z","2022-09-29T00:00:00Z","2021-10-05T00:00:00Z","2021-12-09T00:00:00Z","2021-12-15T00:00:00Z","2022-01-28T00:00:00Z",null,"2021-10-13T00:00:00Z","2021-10-15T00:00:00Z","2021-10-19T00:00:00Z","2021-10-21T00:00:00Z","2021-10-25T00:00:00Z","2021-11-08T00:00:00Z","2021-12-15T00:00:00Z","2021-12-21T00:00:00Z","2022-01-05T00:00:00Z","2021-07-20T00:00:00Z","2021-07-30T00:00:00Z","2021-08-06T00:00:00Z","2021-08-10T00:00:00Z","2021-08-31T00:00:00Z","2021-08-31T00:00:00Z","2021-09-09T00:00:00Z","2021-09-10T00:00:00Z","2021-09-15T00:00:00Z","2022-06-17T00:00:00Z","2022-04-01T00:00:00Z","2022-02-22T00:00:00Z","2022-05-06T00:00:00Z","2022-07-01T00:00:00Z","2022-02-03T00:00:00Z","2022-02-22T00:00:00Z","2022-06-30T00:00:00Z","2022-04-18T00:00:00Z","2022-04-22T00:00:00Z","2022-05-16T00:00:00Z","2022-06-09T00:00:00Z",null,"2022-03-17T00:00:00Z","2022-03-23T00:00:00Z","2022-06-03T00:00:00Z","2022-06-10T00:00:00Z","2022-06-15T00:00:00Z",null,"2021-05-14T00:00:00Z","2021-05-10T00:00:00Z","2021-04-30T00:00:00Z","2021-04-09T00:00:00Z","2021-03-15T00:00:00Z","2021-03-10T00:00:00Z","2021-03-10T00:00:00Z","2021-03-05T00:00:00Z","2021-02-26T00:00:00Z","2021-02-26T00:00:00Z","2021-02-12T00:00:00Z","2021-01-15T00:00:00Z","2021-01-15T00:00:00Z","2021-01-14T00:00:00Z","2020-12-28T00:00:00Z","2020-12-10T00:00:00Z","2020-12-04T00:00:00Z","2020-11-30T00:00:00Z","2020-11-23T00:00:00Z","2020-11-02T00:00:00Z","2020-10-20T00:00:00Z","2020-10-09T00:00:00Z","2020-09-25T00:00:00Z","2020-08-07T00:00:00Z","2020-08-03T00:00:00Z","2020-07-17T00:00:00Z","2020-07-17T00:00:00Z","2020-07-01T00:00:00Z","2020-06-30T00:00:00Z","2020-05-29T00:00:00Z","2020-05-28T00:00:00Z","2020-05-18T00:00:00Z","2020-04-30T00:00:00Z","2020-04-15T00:00:00Z","2020-04-01T00:00:00Z","2020-03-31T00:00:00Z","2020-03-31T00:00:00Z","2020-03-30T00:00:00Z","2020-03-20T00:00:00Z","2020-02-27T00:00:00Z",null,null],"household_annual_income_dpl":[59600.08,58323.44,55016,35459.84,50430.04,48308.58,49463.2,59945.02,37222.95,85764,52434.46,44234.04,52919.98,31054.92,54754.18,27852.5,49860,40154,36088,54432,57008.12,56867,78622.96,40140,37017,58249.04,33280,15342.08,37865.19,37735,49500,38833.6,36691.2,67478.46,33280,39624,47840,27937,42176.33,37582.08,36068,40735,39595.44,35384,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"household_annual_income_spc":[66000.08,"NA","NA",33234,"NA","NA",42000,64428,47544.6,82788,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA",81556,62100,51648,34813,51000,51996,44199.96,30000,67488,40476.84,40428,76548,39377.04,57500.16,60493.92,40427.28,54095,52608,37206.48,29286.6,51612,63626.88,76173,69081.96,45688,76464,50876,53823,83403.84,51956.52,65419.8,55020,42996,82050,28080,65000.04,43525,67550.04,54080,"NA",56000,74448,40707.6,77160,49728,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"client_ami":[0.71,0.58,0.78,0.61,0.77,0.53,0.66,0.59,0.4,0.79,0.8,0.44,0.56,0.47,0.74,0.45,0.55,0.36,0.4,0.59,0.8,0.57,0.88,0.76,0.59,0.53,0.46,0.22,0.62,0.49,0.78,0.65,0.61,0.79,0.33,0.79,0.7,0.51,0.75,0.67,0.59,0.66,0.74,0.4,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"household_size_dpl":[2,6,1,2,1,4,2,5,4,6,1,5,2,1,4,1,4,7,4,5,1,6,4,1,1,7,2,2,2,3,2,1,1,4,6,1,2,2,1,1,2,2,1,6,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"household_size_spc":[2,"NA","NA",2,"NA","NA",2,5,4,6,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA",3,1,4,1,1,3,1,3,5,1,1,4,5,3,6,3,3,2,1,3,4,1,5,2,5,4,2,5,4,2,1,2,2,4,1,3,4,1,4,3,2,4,4,3,1,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"number_of_applicants":[1,1,1,1,1,2,1,2,1,1,1,1,1,1,3,1,1,2,1,2,1,2,"NA",1,1,2,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"fthb":["Yes","Yes","yes","yes","yes","yes","yes","Yes","Yes","Yes","yes","yes","yes","yes","yes","yes","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","Yes","Yes","Yes","Yes","Yes","Yes","YES","YES","Yes","YES","Yes","Yes","Yes","Yes","Yes","Yes","Yes",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"property_street_address":["4756 Clover Ridge Court","1002 Huntwood Lane","2949 Chinkapin Oak Lane","1893 Mt. Airy Rd.","4178 Dauphin Dr","312 Glade Ln","330 Glade Ln","801 Jefferson Dr.","30 Lafayette Dr.","4667 Briarwood Drive","76 Villa Circle","662 Locksley Terrace","1394 Timberwood Blvd","927 Charlton Avenue","412 Wynridge Drive","106 Alto Place","4738 Blue Jay Way","105 Pinewood Court","21 Rolling Hills Road","155 Georgetown Green","818 Nassau Street","814 Nassau Street","4750 Bluejay Way","28 Bolling Circle","320 Riverbend Drive, Apt. 3C","400 Riverside Avenue","42 Villa Circle","546A Cleveland Ave","980 Towne Lane","346 Charney Way","1031 Carrington Place","629 Deerfield Rd","2310 Finch Court","2265 Sparrow Lane","707 Prospect Avenue","86 Villa Circle","2213 Commonwealth Drive","50 Price Road","36 Woodlake Drive","2302 North Berkshire Rd Unit A","2049 Commonwealth Drive","819 Orangedale Ave","1769 Webland View Unit 5","737 Orangedale Ave",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"property_city":["Charlottesville","Charlottesville","Woodbridge","Louisa","Charlottesville","Charlottesville","Charlottesville","Palmyra","Palmyra","Charlottesville","Palmyra","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Ruckersville","Ruckersville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Palmyra","Charlottesville","Charlottesville","Palmyra","Charlottesville","Charlottesville","Palmyra","Charlottesville","Louisa","Charlottesville","Charlottesville","Charlottesville","Palmyra","Charlottesville","Louisa","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"property_state":["VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"property_zip":[22901,22901,22191,23093,22902,22901,22901,22963,22963,22911,22963,22903,22911,22901,22901,22903,22911,22968,22968,22902,22902,22902,22911,22963,22911,22902,22963,22903,22901,22963,22901,23093,22911,22911,22901,22963,22901,23903,22901,22901,22901,22903,22901,22903,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"sale_price_dpl":[285000,314000,332500,170000,243750,235000,243500,268000,278636,200000,172000,221170,264599,271900,260000,254900,200000,200000,183505,229900,215000,215000,257000,177514,163000,231000,166400,170000,189300,134000,233000,128000,181000,245000,155000,159900,186000,152944,174000,178700,156688,126000,181000,145000,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"sale_price_spc":[285000,"NA","NA",170000,"NA","NA",243500,268000,278636,200000,"NA",221170,264599,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA",190000,225000,202000,129000,267000,245000,240000,165000,334000,232000,219500,199797,219900,235000,227000,250000,262000,240000,260000,228600,235000,217380,263500,"NA",285000,289000,224000,289900,210000,265900,300000,266000,220000,247000,170000,293550,225000,205000,300000,269900,226000,249000,210000,265000,255000,270000,315000,130000,234000,250000,217000,244000,195500,200000,246170,208729,162500,174900,239859,195000,222000,254754,194900,208000,229000,253000,235000,194000,248200,152000,180000,245366,284000,218500,206000,28000,191500,173794,285000,202236,215000,157000,250000,120000,265000,223500,245000],"appraised_value":[287000,314000,"NA",173000,245000,235000,247000,270000,"NA","NA",172000,221170,264599,271900,260000,254900,250000,214000,203000,235000,225000,225000,257000,183000,163000,224000,168000,222000,190000,"NA",235000,138000,182000,245000,155000,160000,186000,165000,174000,180000,157000,127000,181000,145000,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"closing_costs_prepaids":[9059.79,17542.16,5197.18,9617.33,7991.75,6805.04,6447.74,8240.49,16450.95,11651.98,12542.1,7009.86,10887.87,5344.6,6906.37,6369.25,7382.83,7182.87,7530.73,11694.35,6380.97,"NA",9644.7,7585.98,5435.08,6038,2500,1250,7118.58,4501.71,7444.58,8422.31,6557.72,7855.49,31000,8035.41,6875,7642,6012.73,6001.9,4998.63,5149.36,7114.03,5754.78,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"lending_institution_dpl":["George Mason Mortgage","Fulton Mortgage","Bank of America","C&F Mortgage Corporation","Fulton Mortgage","Virginia Credit Union","C&F Mortgage Corporation","George Mason Mortgage","Waterstone Mortgage Corporation","Waterstone Mortgage Corporation","Atlantic Bay Mortgage Group","Towne First Mortgage","Residential Home Services","Habitat for Humanity of Greater Charlottesville","Atlantic Coast Mortgage","Habitat for Humanity of Greater Charlottesville","Waterstone Mortgage Corporation","Towne First Mortgage","Waterstone Mortgage Corporation","George Mason Mortgage","Fulton Mortgage","Fulton Mortgage","Fulton Mortgage","George Mason Mortgage","Towne First Mortgage","TowneBank Mortgage","Fulton Mortgage","Habitat for Humanity of Greater Charlottesville","Towne First Mortgage","USDA","Atlantic Coast Mortgage","Atlantic Coast Mortgage","TowneBank Mortgage","George Mason Mortgage","Atlantic Coast Mortgage","NFM Lending","Atlantic Coast Mortgage","USDA","Towne First Mortgage","TowneBank Mortgage","Suntrust Mortgage","Atlantic Coast Mortgage","Movement Mortgage","Atlantic Coast Mortgage",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"lending_institution_spc":["George Mason Mortgage",null,null,"Unknown",null,null,"C&F Mortgage Corporation","George Mason Mortgage","Unknown","Waterstone Mortgage Corporation",null,"Unknown","Unknown",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Movement Mortgage","Waterstone Mortgage Corporation","George Mason Mortgage","George Mason Mortgage","Novus Home Mortgage","Novus Home Mortgage","Novus Home Mortgage","Novus Home Mortgage","Waterstone Mortgage Corporation","Waterstone Mortgage Corporation","Waterstone Mortgage Corporation","Waterstone Mortgage Corporation","Waterstone Mortgage Corporation","Waterstone Mortgage Corporation","Waterstone Mortgage Corporation","Waterstone Mortgage Corporation","Waterstone Mortgage Corporation","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Novus Home Mortgage","Atlantic Bay Mortgage Group","Atlantic Coast Mortgage","Atlantic Coast Mortgage","Atlantic Coast Mortgage","George Mason Mortgage","George Mason Mortgage","George Mason Mortgage","Movement Mortgage","Novus Home Mortgage","Novus Home Mortgage","Novus Home Mortgage","Novus Home Mortgage","Prosperity Home Mortgage","Waterstone Mortgage Corporation","Waterstone Mortgage Corporation","Waterstone Mortgage Corporation","Waterstone Mortgage Corporation","Waterstone Mortgage Corporation","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown","Unknown"],"mortgage_product_dpl":["Conventional","Conventional","Conventional","FHA","Conventional","Conventional","Conventional","Conventional","FHA","502 Direct Loan","502 Direct Loan","VHDA","FHA","Habitat","Conventional","Habitat","Conventional","Conventional","Conventional","Conventional","Conventional","Conventional","Conventional","Conventional","Conventional","Conventional","Conventional","Habitat","VHDA - Bond","502 Direct Loan","Conventional","VHDA - FHA","Other - Bond","Conventional","Conventional","FHA","Conventional","502 Direct Loan","VHDA - Bond","VHDA - Bond","Conventional","VHDA - CHRP","VHDA - FHA","VHDA - CHRP",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"mortgage_product_spc":["Conventional",null,null,"FHA",null,null,"Conventional","Conventional","FHA","502 Direct Loan",null,"Conventional","Conventional",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"FHA","FHA","Conventional","Conventional","502 Direct Loan","VA","502 Direct Loan","FHA","FHA","Conventional","VA","FHA","FHA","FHA","FHA","FHA","FHA","502 Direct Loan","FHA","FHA","FHA","Conventional","502 Direct Loan","FHA","FHA","FHA","FHA","Conventional","FHA","FHA","Unknown","Conventional","Conventional","502 Direct Loan","Conventional","FHA","FHA","502 Direct Loan","FHA","Conventional","Conventional","FHA","FHA","FHA","Conventional","FHA","502 Direct Loan","Conventional","FHA","FHA","FHA","Conventional","502 Direct Loan","FHA","Conventional","FHA","Conventional","FHA","FHA","FHA","FHA","Conventional","FHA","502 Direct Loan","Conventional","FHA","FHA","VA","Conventional","502 Direct Loan","502 Direct Loan","502 Direct Loan","FHA","FHA","Conventional","Unknown","Conventional","FHA","502 Direct Loan","502 Direct Loan","Conventional","FHA","FHA","502 Direct Loan","502 Direct Loan","FHA","FHA"],"mortgage_amount_dpl":[228000,244000,315875,160765,195000,188000,194800,241200,273588,200000,173737,176936,215383,170274,208000,118155,249300,180000,170653,187138,178000,181750,218450,159763,138550,200000,144768,170000,151440,134000,186400,117216,144800,196000,124000,146428,148800,125000,139200,142960,125351,100800,147500,116000,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"mortgage_amount_spc":[228000,"NA","NA",161000,"NA","NA",194800,241200,268883.74,200000,"NA",176936,211679,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA",183350,220924,161600,116100,267000,245000,240000,165000,322310,225044,224548,192804,212203,226775,219055,241250,252830,242424,250900,224600,230743,210859,263500,"NA",275025,279354,224000,231920,202650,256293,291000,239400,209000,247000,164900,293550,220924,205000,294566,261803,219220,240285,206196,255725,247350,265109,315000,105000,226190,250000,209405,236680,195500,196377,238785,216300,146250,174900,235513,188175,222000,247111,188078,208000,206100,244145,226775,194000,240754,152000,180000,245366,274060,214541,185400,282828,184797,177000,276450,204278,208550,154649,245471,121212,265000,223500,237650],"interest_rate_dpl":[0.04875,0.05875,0.02625,0.0225,0.035,0.02875,0.0275,0.0275,0.0175,0.0225,0.03625,0.025,0.02,0,0.03,0,0.0325,0.0325,0.02625,0.025,0.04375,0.04125,0.03875,0.0425,0.02875,0.03625,0.03375,0,0.04375,0.0375,0.04625,0.03875,0.04,0.0475,0.04625,0.05,0.03,0.0325,0.04375,0.04375,0.042,0.0375,0.04875,0.04375,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"interest_rate_spc":[0.04875,"NA","NA",0.015,"NA","NA",0.0275,0.0275,0.0175,0.0225,"NA",0.035,0.0225,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA",0.05,0.0475,0.05125,0.0225,0.0275,"NA","NA","NA",0.02375,0.02375,0.0275,0.025,0.0225,0.0225,0.02375,0.025,0.02625,0.0225,0.0175,0.0225,"NA",0.025,0.02125,0.02375,0.0275,0.02125,0.055,0.0475,0.04125,0.035,0.0375,0.03625,0.04,0.0475,0.05875,0.04625,"NA","NA","NA",0.04375,0.0425,0.06,0.04875,"NA",0.0425,0.02125,0.02,0.035,0.02,0.035,0.0125,0.025,0.015,0.01375,0.02125,0.0175,0.01875,0.0265,0.0175,0.02875,0.0175,0.03,"NA",0.0125,0.02875,0.0275,0.03125,0.0125,0.03625,"NA",0.0275,0.0375,"NA",0.0375,"NA",0.0375,"NA","NA",0.03,0.02875,0.0325,0.03,0.02875,0.02625,0.03625,0.03,0.015],"potential_interest_rate":[0.05875,"NA","NA",0.025,"NA","NA",0.0375,0.0375,0.0275,0.0325,"NA",0.035,0.0225,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA",0.06,0.0575,0.06125,0.0325,0.0375,"NA","NA","NA",0.03375,0.03375,0.0375,0.035,0.0325,0.0325,0.03375,0.035,0.03625,0.0325,0.0275,0.0325,"NA",0.035,0.03125,0.03375,0.0375,0.03125,0.045,0.0375,0.03125,0.045,0.0475,0.02625,0.03,0.0575,0.04875,0.03625,"NA","NA","NA",0.03375,0.0325,0.05,0.05875,0.0475,0.0325,0.03125,0.03,0.045,0.03,0.045,0.0225,0.035,0.025,0.01275,0.02125,0.0175,0.01875,0.0265,0.0175,0.0285,0.0175,0.03,"NA",0.0125,0.02875,0.0275,0.03125,0.0225,0.03625,"NA",0.0275,0.0375,"NA",0.0375,"NA",0.0375,"NA","NA",0.03,0.02875,0.0325,0.03,0.02875,0.02625,0.03625,0.04,0.025],"pha_loans_n":[2,3,0,1,2,2,2,1,0,0,1,2,2,2,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,2,2,1,2,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"pha_loans_amount":[53000,60500,0,17000,48750,47000,47625,26800,0,0,6293.98,44234,52919,13595,52000,12500,19100,20000,14680,45980,37000,33250,38550,17751,24450,24000,16640,10500,37860,6480.85,46600,14563.16,36200,49000,31000,15990,18100,10000,34800,35740,31338,25200,36200,29000,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"pha_loan_source":["ACHAP/ DHCD (albemarle county housing affordability programn)","ACHAP, PHA REGIONAL, CDFI","N/A","DHCD","ACHAP/ DHCD","ACHAP/ DHCD","ACHAP/ DHCD","DHCD","N/A","N/A","CDFI","DHCD and ACHAP","DHCD and ACHAP","City and PHA Regional","DHCD and ACHAP","PHA Regional Fund","ACHAP","CDFI","CDFI","ACHAP & CDFI","City HOME","City HOME","Recycled HOME","CDFI","DHCD HOME","City HOME","DHCD HOME","CAHF","DHCD HOME","Recycled Home","DHCD HOME Perf Pool","CDFI","DHCD HOME","DHCD HOME","CAHF","Recycled Home","CFDI and ACHAP","LCHAP","DHCD HOME","CAHF","DHCD HOME and Recycled HOME","CAHF and Recycled HOME","DHCD HOME","CAHF and Recycled HOME",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"dhcd":[1,0,0,1,1,1,1,1,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,1,0,1,1,0,0,0,0,1,0,1,0,1,0,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"achap":[1,1,0,0,1,1,1,0,0,0,0,1,1,0,1,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"cdfi":[0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"pha_regional":[0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"city":[0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"cahf":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,1,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"recycled_home":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,1,0,1,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"lchap":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"multiple_loans":[2,2,0,1,2,2,2,1,0,0,1,2,2,2,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,2,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"other_assistance":["SPARC & VIDA",null,"VIDA","SPARC",null,null,"SPARC","SPARC","SPARC & VIDA","VIDA & SPARC",null,null,"SPARC",null,null,null,null,null,"SPARC",null,null,null,null,null,null,null,null,"FHLB, City HOME, Habitat",null,"None","None","VHDA Grant",null,"NA","NA","NA","NA","VIDA","none","Fannie Mae CC ast","none","Seller Credit, SPARC","none","Friend Gift, SPARC",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"other_assistance_amount":[4000,"NA",4000,"NA","NA","NA","NA","NA",4000,4000,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA",75528,"NA","NA","NA",3200,"NA","NA","NA","NA","NA",4545,"NA",1500,"NA",3910.27,"NA",3878.41,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"client_street_address":["4287 Plank Road","2376 Abington Lane","14960 Potomac Heights Place, Apt. 214","304 Martinsville Avenue","224 Riverside Drive","2241 Commonwealth Drive, Apt. D","201-A Holly Drive","1222 Smith Street","1207-B Villa Lane","2382 Abington Drive","1446 Minor Ridge","426 Garrett Street, Apt. D","1914 Cedar Hill Road, Apt. A","927 Charlton Avenue","1255 Maple View Drive","408 Garrett Street","918-A South 1st Street","404 Robertson Avenue","166 Georgetown Road","2309 Peyton Drive, Apt. A","217-B Stribling Avenue","754 Prospect Avenue, Apt. C","675 Woodbrook Drive, Apt 102","84 Timber Road","2405 Peyton Drive, Apt. 204","400 Riverside Avenue","253 Colonade Drive, Apt. 21","546-A Cleveland Avenue","258 Colonnade Drive","2948 Mountain Hill Rd","2527 Hydraulic Road Apt 40","63 Robins Court","808 Orangedale Ave","2226 Commonwealth Drive Apt F","1229 Agnese Street","110 A Welk Place","2213 Commonwealth Drive","356 Zion Road","4081 Cypress Pointe Drive","140 Green Turtle Lane #1","1356 Villa Way Apt A","768 Prospect Ave #C","1614 Calvary Circle","1115 Forest Street Apt A",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"client_city":["North Garden","Charlottesville","Woodbridge","Gordonsville","Lynchburg","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Columbia","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Palmyra","Charlottesville","Palmyra","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Gordonsville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville","Charlottesville",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"client_state":["VA","VA","VA","VA","VA","VA","VA","vA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA","VA",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"client_zip":[22959,22911,22191,22942,24503,22901,22903,22901,22903,22911,22901,22902,22901,22902,22902,22902,22902,22903,22901,22901,22903,22903,22901,23038,22901,22902,22903,22903,22903,22963,22901,22963,22903,22901,22901,22903,22901,22942,22901,22901,22903,22903,22911,22903,"NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA"],"ethnicity":["Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Hispanic","Not Hispanic","Not Hispanic","Chose not to respond","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Chose not to respond","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Not Hispanic","Hispanic","Not Hispanic","Not Hispanic",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"multirace":["Single","Single","Single","Single","Single","Single","Single","Single","Single","Single","Single","Single","Multiple","Single","Multiple","Single","Single","Single","Single","Multiple","Single","Single","Single","Multiple","Single","Multiple","Single","Single","Single","Single","Single","Single","Single","Single","Single","Single","Single","Single","Multiple","Single","Single","Single","Single","Single",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"race":["White","White","Black","Black","White","Asian","Black","Black","Black","Black","Black","Asian","Other races","Black","Other races","Black","White","Asian","White","Black and White","White","Asian","Black","Black and White","White","Other races","Asian","White","White","Black","White","White","Black","White","White","Black","Black","Black","Black and White","White","White","White","White","White",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"income_ami_level":["50 - 79% AMI","50 - 79% AMI","50 - 79% AMI","50 - 79% AMI","50 - 79% AMI","50 - 79% AMI","50 - 79% AMI","50 - 79% AMI","30 - 49% AMI","50 - 79% AMI","80 - 100% AMI","30 - 49% AMI","50 - 79% AMI","30 - 49% AMI","50 - 79% AMI","30 - 49% AMI","50 - 79% AMI","50 - 79% AMI","30 - 49% AMI",null,"50 - 79% AMI","30 - 49% AMI","50 - 79% AMI","50 - 79% AMI","50 - 79% AMI","30 - 49% AMI","30 - 49% AMI","< 30 % AMI","50 - 79% AMI","30 - 49% AMI","50 - 79% AMI","50 - 79% AMI","50 - 79% AMI","50 - 79% AMI","50 - 79% AMI","50 - 79% AMI","50 - 79% AMI","50 - 79% AMI","80 - 100% AMI","50 - 79% AMI","50 - 79% AMI","50 - 79% AMI","80 - 100% AMI","30 - 49% AMI",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"rural_area_status":["Rural","Rural","Not rural","Rural","Not rural","Not rural","Not rural","Not rural","Not rural","Not rural","Rural","Not rural","Not rural","Not rural","Rural","Not rural","Rural","Not rural","Not rural","Rural","Not rural","Not rural","Not rural","Rural","Not rural","Not rural","Not rural","Not rural","Not rural","Rural","Not rural","Rural","Not rural","Not rural","Not rural","Not rural","Rural","Rural","Not rural","Not rural","Rural","Not rural","Rural","Not rural",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"english_proficiency":["Proficient","Proficient","Proficient","Proficient","Proficient","Proficient","Proficient","Proficient","Proficient","Proficient","Proficient","Not proficient","Proficient","Proficient","Proficient","Proficient","Proficient","Not proficient","Proficient","Proficient","Proficient","Not proficient","Proficient","Proficient","Proficient","Proficient","Proficient","Not proficient","Proficient","Proficient","Proficient","Proficient","Proficient","Not proficient","Not proficient","Not proficient","Proficient","Proficient","Proficient","Proficient","Proficient","Proficient","Proficient","Proficient",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"referral_source":["Friend","PHA Website",null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Friend",null,null,null,null,null,null,null,"Family",null,null,null,null,null,"Friend",null,null,"Friend",null,null,null,"Fluvanna Louisa Housing Foundation","Co-Worker","Co-Worker","Friend","Lender","PHA","International Rescue Committee",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"locality":["Albemarle",null,null,"Louisa",null,null,"Albemarle","Fluvanna","Fluvanna","Charlottesville",null,"Albemarle","Albemarle",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Fluvanna","Albemarle","Fluvanna","Albemarle","Louisa","Albemarle","Albemarle","Louisa","Albemarle","Albemarle","Albemarle","Fluvanna","Louisa","Albemarle","Nelson","Fluvanna","Louisa","Gordonsville","Louisa","Louisa","Fluvanna","Albemarle","Fluvanna","Charlottesville","Louisa","Greene","Fluvanna","Albemarle","Fluvanna","Greene","Albemarle","Greene","Albemarle","Louisa","Staunton","Louisa","Louisa","Fluvanna","Fluvanna","Albemarle","Louisa","Louisa","Fluvanna","Albemarle","Louisa","Louisa","Fluvanna","Fluvanna","Louisa","Albemarle","Louisa","Albemarle","Louisa","Louisa","Louisa","Fluvanna","Albemarle","Louisa","Louisa","Albemarle","Louisa","Louisa","Fluvanna","Louisa","Charlottesville","Louisa","Louisa","Fluvanna","Fluvanna","Albemarle","Albemarle","Louisa","Louisa","Louisa","Albemarle","Fluvanna","Albemarle","Fluvanna","Albemarle","Fluvanna","Albemarle","Greene","Louisa","Nelson","Louisa","Fluvanna","Fluvanna"],"mortgage_notes":[null,null,null,null,null,null,null,"Reduced mortgage insurance",null,null,null,"Reduced mortgage insurance","Reduced mortgage insurance",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Second Plus",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Reduced mortgage insurance",null,null,null,null,null,null,null,null,null,"Reduced mortgage insurance","No mortgage insurance",null,null,null,null,null,null,"Reduced mortgage insurance",null,null,null,null,null,null,null,"Reduced mortgage insurance",null,null,null,"Reduced mortgage insurance",null,null,"Reduced mortgage insurance",null,"Reduced mortgage insurance",null,null,null,null,"Reduced mortgage insurance",null,null,"Reduced mortgage insurance",null,null,null,"Reduced mortgage insurance",null,null,null,null,null,"Reduced mortgage insurance",null,"Reduced mortgage insurance",null,null,null,"Reduced mortgage insurance",null,null,null,null,null,null],"verified_close_date_in_gis":["2022-07-27T00:00:00Z",null,null,null,null,null,"2021-10-13T00:00:00Z","2021-12-15T00:00:00Z",null,"2022-02-28T00:00:00Z",null,"2020-08-24T00:00:00Z","2020-10-13T00:00:00Z",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2021-09-23T00:00:00Z","2021-12-07T00:00:00Z","2021-12-09T00:00:00Z","2022-01-28T00:00:00Z",null,"2021-10-19T00:00:00Z","2021-10-18T00:00:00Z","2021-10-26T00:00:00Z","2021-10-28T00:00:00Z","2021-10-25T00:00:00Z","2021-11-30T00:00:00Z","2022-01-25T00:00:00Z","2022-01-22T00:00:00Z","2022-01-07T00:00:00Z",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2021-04-05T00:00:00Z","2021-03-10T00:00:00Z","2021-04-13T00:00:00Z","2021-02-15T00:00:00Z",null,null,"2021-01-21T00:00:00Z",null,"2021-03-10T00:00:00Z","2020-12-30T00:00:00Z",null,"2021-02-01T00:00:00Z","2020-12-15T00:00:00Z",null,"2020-11-04T00:00:00Z","2020-11-09T00:00:00Z","2021-03-10T00:00:00Z",null,"2020-07-31T00:00:00Z",null,"2020-07-31T00:00:00Z","2021-03-10T00:00:00Z","2021-03-10T00:00:00Z",null,"2020-10-02T00:00:00Z","2020-05-28T00:00:00Z","2020-05-18T00:00:00Z","2020-05-18T00:00:00Z","2020-04-10T00:00:00Z","2020-04-22T00:00:00Z","2020-03-31T00:00:00Z",null,null,null,"2021-03-10T00:00:00Z","2020-11-09T00:00:00Z",null],"received_cd":["Yes",null,null,"Yes",null,null,"Yes","Yes","Yes","Yes",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes",null,null,null,null,null,null,null,null,null,"Yes","Yes",null,null,null,null,null,null,"Yes","Yes","Yes","No","Yes",null,null,null,"Yes","Yes","Yes",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"in_ors":["Yes",null,null,"Yes",null,null,"Yes","Yes","Yes","Yes",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"Yes","Yes","Yes","Yes","No","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","No","No","No","No","No","No","No","No","No","Yes","Yes",null,null,null,null,null,null,"Yes","Yes",null,null,null,"Yes",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]},"columns":[{"id":"id_pha","name":"id_pha","type":"character","minWidth":150},{"id":"program","name":"program","type":"character","minWidth":150},{"id":"client_number","name":"client_number","type":"character","minWidth":150},{"id":"id_dpl","name":"id_dpl","type":"character","minWidth":150},{"id":"id_sparc","name":"id_sparc","type":"character","minWidth":150},{"id":"contract_date","name":"contract_date","type":"Date","minWidth":150},{"id":"close_date_dpl","name":"close_date_dpl","type":"Date","minWidth":150},{"id":"close_date_spc","name":"close_date_spc","type":"Date","minWidth":150},{"id":"household_annual_income_dpl","name":"household_annual_income_dpl","type":"numeric","minWidth":150},{"id":"household_annual_income_spc","name":"household_annual_income_spc","type":"numeric","minWidth":150},{"id":"client_ami","name":"client_ami","type":"numeric","minWidth":150},{"id":"household_size_dpl","name":"household_size_dpl","type":"numeric","minWidth":150},{"id":"household_size_spc","name":"household_size_spc","type":"numeric","minWidth":150},{"id":"number_of_applicants","name":"number_of_applicants","type":"numeric","minWidth":150},{"id":"fthb","name":"fthb","type":"character","minWidth":150},{"id":"property_street_address","name":"property_street_address","type":"character","minWidth":150},{"id":"property_city","name":"property_city","type":"character","minWidth":150},{"id":"property_state","name":"property_state","type":"character","minWidth":150},{"id":"property_zip","name":"property_zip","type":"numeric","minWidth":150},{"id":"sale_price_dpl","name":"sale_price_dpl","type":"numeric","minWidth":150},{"id":"sale_price_spc","name":"sale_price_spc","type":"numeric","minWidth":150},{"id":"appraised_value","name":"appraised_value","type":"numeric","minWidth":150},{"id":"closing_costs_prepaids","name":"closing_costs_prepaids","type":"numeric","minWidth":150},{"id":"lending_institution_dpl","name":"lending_institution_dpl","type":"character","minWidth":150},{"id":"lending_institution_spc","name":"lending_institution_spc","type":"character","minWidth":150},{"id":"mortgage_product_dpl","name":"mortgage_product_dpl","type":"character","minWidth":150},{"id":"mortgage_product_spc","name":"mortgage_product_spc","type":"character","minWidth":150},{"id":"mortgage_amount_dpl","name":"mortgage_amount_dpl","type":"numeric","minWidth":150},{"id":"mortgage_amount_spc","name":"mortgage_amount_spc","type":"numeric","minWidth":150},{"id":"interest_rate_dpl","name":"interest_rate_dpl","type":"numeric","minWidth":150},{"id":"interest_rate_spc","name":"interest_rate_spc","type":"numeric","minWidth":150},{"id":"potential_interest_rate","name":"potential_interest_rate","type":"numeric","minWidth":150},{"id":"pha_loans_n","name":"pha_loans_n","type":"numeric","minWidth":150},{"id":"pha_loans_amount","name":"pha_loans_amount","type":"numeric","minWidth":150},{"id":"pha_loan_source","name":"pha_loan_source","type":"character","minWidth":150},{"id":"dhcd","name":"dhcd","type":"numeric","minWidth":150},{"id":"achap","name":"achap","type":"numeric","minWidth":150},{"id":"cdfi","name":"cdfi","type":"numeric","minWidth":150},{"id":"pha_regional","name":"pha_regional","type":"numeric","minWidth":150},{"id":"city","name":"city","type":"numeric","minWidth":150},{"id":"cahf","name":"cahf","type":"numeric","minWidth":150},{"id":"recycled_home","name":"recycled_home","type":"numeric","minWidth":150},{"id":"lchap","name":"lchap","type":"numeric","minWidth":150},{"id":"multiple_loans","name":"multiple_loans","type":"numeric","minWidth":150},{"id":"other_assistance","name":"other_assistance","type":"character","minWidth":150},{"id":"other_assistance_amount","name":"other_assistance_amount","type":"numeric","minWidth":150},{"id":"client_street_address","name":"client_street_address","type":"character","minWidth":150},{"id":"client_city","name":"client_city","type":"character","minWidth":150},{"id":"client_state","name":"client_state","type":"character","minWidth":150},{"id":"client_zip","name":"client_zip","type":"numeric","minWidth":150},{"id":"ethnicity","name":"ethnicity","type":"character","minWidth":150},{"id":"multirace","name":"multirace","type":"character","minWidth":150},{"id":"race","name":"race","type":"character","minWidth":150},{"id":"income_ami_level","name":"income_ami_level","type":"character","minWidth":150},{"id":"rural_area_status","name":"rural_area_status","type":"character","minWidth":150},{"id":"english_proficiency","name":"english_proficiency","type":"character","minWidth":150},{"id":"referral_source","name":"referral_source","type":"character","minWidth":150},{"id":"locality","name":"locality","type":"character","minWidth":150},{"id":"mortgage_notes","name":"mortgage_notes","type":"character","minWidth":150},{"id":"verified_close_date_in_gis","name":"verified_close_date_in_gis","type":"Date","minWidth":150},{"id":"received_cd","name":"received_cd","type":"character","minWidth":150},{"id":"in_ors","name":"in_ors","type":"character","minWidth":150}],"defaultPageSize":5,"striped":true,"compact":true,"nowrap":true,"dataKey":"070c7d85b89464835830c25a9284476a"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Where there were duplicate fields from each dataset, the <code>_dpl</code> and <code>_spc</code> suffixes were added to the end of column names, respective to their source. For example, the close date data from the DPL records are retained as the <code>close_date_dpl</code> column, while the close dates from the SPARC data are <code>close_date_spc</code>.</p>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Data integrity issues
</div>
</div>
<div class="callout-body-container callout-body">
<p>Both the DPL and SPARC datasets were found to have data integrity issues that PHA should resolve in the future.</p>
<ul>
<li><p>Mortgage product fields included both “RHS” (Rural Housing Service), “USDA”, and “502” values. For now, these are all assumed to be “502 Direct Loans”.</p></li>
<li><p>Overlapping fields from the DPL and SPARC datasets do not always reconcile for the clients who used both programs. For example, the specific close dates and household income values are often slightly different—but should, in theory, be identical.</p></li>
<li><p>The SPARC client records are missing many values in the closing date, interest rate, household income, household size, and lender columns.</p></li>
<li><p>Some DPL clients were noted as receiving SPARC in the <code>other_assistance</code> column. However, two of clients were <em>not</em> found in the SPARC data.</p></li>
</ul>
</div>
</div>
</section>
<section id="regional-and-neighborhood-profiles" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="regional-and-neighborhood-profiles"><span class="header-section-number">2.2</span> Regional and neighborhood profiles</h2>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Why this is needed
</div>
</div>
<div class="callout-body-container callout-body">
<p>Demographic and socioeconomic data will help establish the baseline characteristics of population groups that PHA seeks to compare with its clients. For example, how closely does the client pool match the average racial and ethnic makeup across the region?</p>
</div>
</div>
<p>Two datasets will be used to create summary profiles of the geographies PHA will use as reference for its clients’ characteristics. Both are from the U.S. Census Bureau:</p>
<ul>
<li>2020 Decennial Census</li>
<li>American Community Survey (5-year estimates)</li>
</ul>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>As of January 2023, the latest ACS data available are the 2017-2021 5-year estimates.</p>
</div>
</div>
<p>The fields to collect from this data include:</p>
<ul>
<li>Race and ethnicity of population</li>
<li>Average household incomes</li>
<li>Homeownership rates</li>
</ul>
<p><strong>Step 1: Race and ethnicity data from 2020 Census</strong></p>
<div class="cell">
<details>
<summary>Import data</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get variables for 2020 Census PL-94171 Redistricting dataset</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>pl_vars <span class="ot">&lt;-</span> <span class="fu">load_variables</span>(<span class="dv">2020</span>, <span class="st">"pl"</span>, <span class="at">cache =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Find and select race and ethnicity variables</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>race_vars <span class="ot">&lt;-</span> pl_vars <span class="sc">|&gt;</span> </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P1_003N"</span>, <span class="co"># White</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P1_004N"</span>, <span class="co"># Black</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P1_005N"</span>, <span class="co"># American Indian and Alaska Native</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P1_006N"</span>, <span class="co"># Asian</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P1_007N"</span>, <span class="co"># Native Hawaiian and Other Pacific Islander</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P1_008N"</span>, <span class="co"># Some other race</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P1_009N"</span>, <span class="co"># Two or more races</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2_002N"</span>, <span class="co"># Total Hispanic or Latino</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P2_003N"</span>  <span class="co"># Total not Hispanic or Latino</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rename race and ethnicity groups </span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span> <span class="st">"P1_003N"</span> <span class="sc">~</span> <span class="st">"White"</span>,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span> <span class="st">"P1_004N"</span> <span class="sc">~</span> <span class="st">"Black"</span>,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span> <span class="st">"P1_005N"</span> <span class="sc">~</span> <span class="st">"Another race"</span>,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span> <span class="st">"P1_006N"</span> <span class="sc">~</span> <span class="st">"Asian"</span>,</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span> <span class="st">"P1_007N"</span> <span class="sc">~</span> <span class="st">"Another race"</span>,</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span> <span class="st">"P1_008N"</span> <span class="sc">~</span> <span class="st">"Another race"</span>,</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span> <span class="st">"P1_009N"</span> <span class="sc">~</span> <span class="st">"Multiracial"</span>,</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span> <span class="st">"P2_002N"</span> <span class="sc">~</span> <span class="st">"Hispanic or Latino"</span>,</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span> <span class="st">"P2_003N"</span> <span class="sc">~</span> <span class="st">"Not Hispanic or Latino"</span>,</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add race/ethnicity label</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">category =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(name, <span class="st">"P1"</span>) <span class="sc">~</span> <span class="st">"Race"</span>,</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Ethnicity"</span>),</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">.after =</span> <span class="dv">1</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Drop concept column (unneeded)</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>concept)</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Import 2020 Census race and ethnicity data for Charlottesville City</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>cv_race_raw <span class="ot">&lt;-</span> <span class="fu">get_decennial</span>(</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> race_vars<span class="sc">$</span>name,</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span>,</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">sumfile =</span> <span class="st">"pl"</span>,</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"VA"</span>,</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">county =</span> <span class="st">"Charlottesville city"</span>,</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">cache_table =</span> <span class="cn">TRUE</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Prep data</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join race and ethnicity labels</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>cv_race <span class="ot">&lt;-</span> cv_race_raw <span class="sc">|&gt;</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(race_vars, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"variable"</span> <span class="ot">=</span> <span class="st">"name"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sum "Another race" values into one row</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(category, label) <span class="sc">|&gt;</span> </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">value =</span> <span class="fu">sum</span>(value)) <span class="sc">|&gt;</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add percent column</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(category) <span class="sc">|&gt;</span> </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> value<span class="sc">/</span><span class="fu">sum</span>(value)) <span class="sc">|&gt;</span> </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate table</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>cv_race <span class="sc">|&gt;</span> </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(value), <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> category </th>
   <th style="text-align:left;"> label </th>
   <th style="text-align:right;"> value </th>
   <th style="text-align:right;"> pct </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Ethnicity </td>
   <td style="text-align:left;"> Not Hispanic or Latino </td>
   <td style="text-align:right;"> 43346 </td>
   <td style="text-align:right;"> 0.9311108 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Race </td>
   <td style="text-align:left;"> White </td>
   <td style="text-align:right;"> 30344 </td>
   <td style="text-align:right;"> 0.6518162 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Race </td>
   <td style="text-align:left;"> Black </td>
   <td style="text-align:right;"> 7122 </td>
   <td style="text-align:right;"> 0.1529869 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Race </td>
   <td style="text-align:left;"> Asian </td>
   <td style="text-align:right;"> 4083 </td>
   <td style="text-align:right;"> 0.0877065 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Race </td>
   <td style="text-align:left;"> Multiracial </td>
   <td style="text-align:right;"> 3583 </td>
   <td style="text-align:right;"> 0.0769660 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Ethnicity </td>
   <td style="text-align:left;"> Hispanic or Latino </td>
   <td style="text-align:right;"> 3207 </td>
   <td style="text-align:right;"> 0.0688892 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Race </td>
   <td style="text-align:left;"> Another race </td>
   <td style="text-align:right;"> 1421 </td>
   <td style="text-align:right;"> 0.0305243 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p><strong>Step 2: Household income data from ACS</strong></p>
<div class="cell">
<details>
<summary>Import data</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get variables for Table B25118: Tenure by Household Income</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>b25118_vars <span class="ot">&lt;-</span> <span class="fu">load_variables</span>(<span class="dv">2021</span>, <span class="st">"acs5"</span>, <span class="at">cache =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_sub</span>(name, <span class="at">end =</span> <span class="dv">6</span>) <span class="sc">%in%</span> <span class="st">"B25118"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean variables</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>inc_vars <span class="ot">&lt;-</span> b25118_vars <span class="sc">|&gt;</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(label, <span class="fu">c</span>(<span class="st">"est"</span>, <span class="st">"total"</span>, <span class="st">"tenure"</span>, <span class="st">"income"</span>), <span class="at">sep =</span> <span class="st">"!!"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tenure =</span> <span class="fu">str_remove_all</span>(tenure, <span class="st">" occupied:"</span>),</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">tenure =</span> <span class="fu">str_replace_all</span>(tenure, <span class="st">"Owner"</span>, <span class="st">"Homeowner"</span>))</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Import 2021 ACS estimates</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>b25118_raw <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> inc_vars<span class="sc">$</span>name,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2021</span>,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">county =</span> <span class="st">"Charlottesville city"</span>,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"VA"</span>,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">cache_table =</span> <span class="cn">TRUE</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Prep data</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join variables to data</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>cv_income <span class="ot">&lt;-</span> b25118_raw <span class="sc">|&gt;</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(inc_vars, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"variable"</span> <span class="ot">=</span> <span class="st">"name"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove unnecessary columns and rearrange</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Collapse into fewer income categories</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">income =</span> <span class="fu">case_when</span>(</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    income <span class="sc">==</span> <span class="st">"Less than $5,000"</span> <span class="sc">~</span> <span class="st">"Less than $35,000"</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    income <span class="sc">==</span> <span class="st">"$5,000 to $9,999"</span> <span class="sc">~</span> <span class="st">"Less than $35,000"</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    income <span class="sc">==</span> <span class="st">"$10,000 to $14,999"</span> <span class="sc">~</span> <span class="st">"Less than $35,000"</span>,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    income <span class="sc">==</span> <span class="st">"$15,000 to $19,999"</span> <span class="sc">~</span> <span class="st">"Less than $35,000"</span>,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    income <span class="sc">==</span> <span class="st">"$20,000 to $24,999"</span> <span class="sc">~</span> <span class="st">"Less than $35,000"</span>,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    income <span class="sc">==</span> <span class="st">"$25,000 to $34,999"</span> <span class="sc">~</span> <span class="st">"Less than $35,000"</span>,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    income <span class="sc">==</span> <span class="st">"$100,000 to $149,999"</span> <span class="sc">~</span> <span class="st">"$100,000 or more"</span>,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    income <span class="sc">==</span> <span class="st">"$150,000 or more"</span> <span class="sc">~</span> <span class="st">"$100,000 or more"</span>,</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> income</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tenure, income) <span class="sc">|&gt;</span> </span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">estimate =</span> <span class="fu">sum</span>(estimate))</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate table</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>cv_income <span class="sc">|&gt;</span> </span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">income =</span> <span class="fu">fct_relevel</span>(income, <span class="st">"Less than $35,000"</span>, <span class="st">"$35,000 to $49,999"</span>,</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"$50,000 to $74,999"</span>, <span class="st">"$75,000 to $99,999"</span>,</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"$100,000 or more"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(income) <span class="sc">|&gt;</span> </span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>)</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> tenure </th>
   <th style="text-align:left;"> income </th>
   <th style="text-align:right;"> estimate </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Homeowner </td>
   <td style="text-align:left;"> Less than $35,000 </td>
   <td style="text-align:right;"> 883 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Renter </td>
   <td style="text-align:left;"> Less than $35,000 </td>
   <td style="text-align:right;"> 5140 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Homeowner </td>
   <td style="text-align:left;"> $35,000 to $49,999 </td>
   <td style="text-align:right;"> 764 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Renter </td>
   <td style="text-align:left;"> $35,000 to $49,999 </td>
   <td style="text-align:right;"> 1234 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Homeowner </td>
   <td style="text-align:left;"> $50,000 to $74,999 </td>
   <td style="text-align:right;"> 861 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Renter </td>
   <td style="text-align:left;"> $50,000 to $74,999 </td>
   <td style="text-align:right;"> 1809 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Homeowner </td>
   <td style="text-align:left;"> $75,000 to $99,999 </td>
   <td style="text-align:right;"> 1171 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Renter </td>
   <td style="text-align:left;"> $75,000 to $99,999 </td>
   <td style="text-align:right;"> 985 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Homeowner </td>
   <td style="text-align:left;"> $100,000 or more </td>
   <td style="text-align:right;"> 4300 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Renter </td>
   <td style="text-align:left;"> $100,000 or more </td>
   <td style="text-align:right;"> 2165 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p><strong>Step 3: Homeownership data from ACS</strong></p>
<div class="cell">
<details>
<summary>Import data</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tbd</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Prep data</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tbd</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="mortgage-applications-and-activity" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="mortgage-applications-and-activity"><span class="header-section-number">2.3</span> Mortgage applications and activity</h2>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Why this is needed
</div>
</div>
<div class="callout-body-container callout-body">
<p>Along with comparing client characteristics with the region or a neighborhood as a whole, we can compare their mortgages to overall lending activity in the community over time. This will allow PHA to benchmark its buyer assistance efforts to home loan trends across the region.</p>
</div>
</div>
<p>This information is available from the Home Mortgage Disclosure Act (HMDA) data from the Consumer Financial Protection Bureau. HMDA data include loan-level information on buyer demographics, loan attributes, and property characteristics. Entries for buyers whose applications were eventually withdrawn or denied are also included.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>As of January 2023, the latest HMDA data available is for 2021.</p>
</div>
</div>
<p>The fields to collect from this data include:</p>
<ul>
<li>Buyer race and ethnicity</li>
<li>Buyer county and census tract</li>
<li>Loan type (conventional, FHA, VA, or USDA)</li>
<li>Action taken (loan originated, application denied or withdrawn)</li>
<li>Loan amount</li>
<li>Interest rate</li>
<li>Property value</li>
<li>Occupancy type (principal residence only)</li>
<li>Buyer gross annual income</li>
<li>Debt-to-income ratio</li>
</ul>
<p><code>Add steps on cleaning/preparing this data</code></p>
</section>
<section id="home-values" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="home-values"><span class="header-section-number">2.4</span> Home values</h2>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Why this is needed
</div>
</div>
<div class="callout-body-container callout-body">
<p>Detailed data on home sales and values are necessary to make estimates about the total home equity gained (or lost) by PHA buyers and other homeowners in the community. This property-level data will help PHA assess its programs’ abilities to support wealth-building among clients.</p>
</div>
</div>
<section id="real-estate-assessments" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="real-estate-assessments"><span class="header-section-number">2.4.1</span> Real estate assessments</h3>
<p>Localities in PHA’s service area regularly assess property values to calculate the total real estate taxes to be paid by each property owner. Properties are reassessed to better match taxable values with potential market values, which can change significantly over time.</p>
<p>Despite these updates, local assessments can often lag behind current market trends, so they are not the most accurate indicator of the actual market value of a home if it were sold. Still, assessment data are consistent and publicly available for all parcels in a locality. This creates a useful longitudinal dataset.</p>
<p>For this preliminary analysis, only assessment data from the City of Charlottesville will be used.</p>
<p>The fields to collect from this data include:</p>
<ul>
<li>Parcel number</li>
<li>Street number and name</li>
<li>Bedrooms and bathrooms</li>
<li>Finished square footage</li>
<li>Total assessed value</li>
</ul>
<div class="cell">
<details>
<summary>View assessment code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in multi-year assessment data</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>cv_assess <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/raw/Real_Estate_(All_Assessments).csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter tax years 2017 and later</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TaxYear <span class="sc">&gt;</span> <span class="dv">2016</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Keep only relevant fields</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ParcelNumber, TotalValue, TaxYear)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>View parcel code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in detailed residential property data</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>cv_residential <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/raw/Real_Estate_(Residential_Details).csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter for single-family types only</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(UseCode, <span class="st">"Single Family"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Keep only relevant fields</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ParcelNumber, StreetNumber, StreetName, Bedrooms, HalfBathrooms,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>         FullBathrooms, <span class="at">SqFt =</span> SquareFootageFinishedLiving)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Load shapefile of parcels</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>cv_parcels <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/shp/Parcel_Area_Details.shp"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fix column name</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">ParcelNumber =</span> ParcelNumb) <span class="sc">|&gt;</span> </span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join to detailed residential property data</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(cv_residential, <span class="at">by =</span> <span class="st">"ParcelNumber"</span>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Save data</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cv_parcels, <span class="st">"data/cv_parcels.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="mls-sales" class="level3" data-number="2.4.2">
<h3 data-number="2.4.2" class="anchored" data-anchor-id="mls-sales"><span class="header-section-number">2.4.2</span> MLS sales</h3>
<p>Actual recorded home sales are the most accurate way to determine residential property values. For arms-length transactions, sales prices reflect the actual market value of each home. These records are therefore the ideal source to best determine home equity changes among homeowners.</p>
<p>PHA is able to provide data exported from the multiple listing service (MLS) operated by the Charlottesville Area Association of REALTORS® (CAAR). The MLS platform includes all real estate listings from agents in the region and is dynamically updated as listings are added, updated, or closed.</p>
<p>For this preliminary analysis, PHA has provided data on all sold single-family homes in the City of Charlottesville from September 2022 through November 22, 2022.</p>
<p>Fields included in this exports include:</p>
<ul>
<li>Property address</li>
<li>Days on market</li>
<li>List price</li>
<li>Closed date</li>
<li>Bedrooms and bathrooms</li>
<li>Finished square footage</li>
</ul>
<div class="cell">
<details>
<summary>View code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in records exported from MLS and clean column names</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>mls <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/raw/Default_MLS_Defined_Spreadsheet.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Keep only relevant fields</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(address, city, closed_date, number_beds, number_baths, total_sq_ft, list_price)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Add state field and geocode addresses</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>mls_geocode <span class="ot">&lt;-</span> mls <span class="sc">|&gt;</span> </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state =</span> <span class="st">"VA"</span>, <span class="at">.before =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geocode</span>(<span class="at">street =</span> address,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">state =</span> state,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">city =</span> city,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">method =</span> <span class="st">"geocodio"</span>,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">lat =</span> lat,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">long =</span> long) <span class="sc">|&gt;</span> </span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Drop records that did not match</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(lat) <span class="sc">|&gt;</span> </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Specify WGS 1984 coordinate system for lat/long data</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"long"</span>, <span class="st">"lat"</span>),</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">remove =</span> <span class="cn">FALSE</span>,</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Project into Virginia State Plane South</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="dv">4502</span>)</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Save data</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(mls_geocode, <span class="st">"data/mls_geocode.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="other-data" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="other-data"><span class="header-section-number">2.5</span> Other data</h2>
<p><code>May or may not eventually be used</code></p>
<ul>
<li>Neighborhood boundaries from City of Charlottesville (<a href="https://opendata.charlottesville.org/datasets/charlottesville::planning-neighborhood-area/about">link</a>)</li>
<li>Real estate sales (<a href="https://opendata.charlottesville.org/maps/real-estate-sales">link</a>)</li>
</ul>
</section>
</section>
<section id="analysis" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Analysis</h1>
<section id="clients-served-by-program" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="clients-served-by-program"><span class="header-section-number">3.1</span> Clients served by program</h2>
<p>From July 2017 through September 2022, PHA served a total of 131 households with its DPL and SPARC programs.</p>
<div class="cell">
<details>
<summary>View code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cumulative total served by program</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>clients_total <span class="ot">&lt;-</span> clients_all <span class="sc">|&gt;</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(program, close_date_dpl, close_date_spc) <span class="sc">|&gt;</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Collapse close dates into one column</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assume DPL close date is correct when SPARC date differs</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">close_date =</span> <span class="fu">case_when</span>(</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(close_date_dpl) <span class="sc">~</span> close_date_dpl,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> close_date_spc</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarise clients by month</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>clients_cum <span class="ot">&lt;-</span> clients_total <span class="sc">|&gt;</span> </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(close_date) <span class="sc">|&gt;</span>     </span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(program, <span class="at">month =</span> <span class="fu">floor_date</span>(close_date, <span class="st">"month"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(program, month, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="dv">0</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Cumulative sum by program</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(program) <span class="sc">|&gt;</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cum_sum =</span> <span class="fu">cumsum</span>(n))</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(clients_cum, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> cum_sum, <span class="at">fill =</span> program)) <span class="sc">+</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>() <span class="sc">+</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">100</span>,<span class="dv">125</span>)) <span class="sc">+</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_hda</span>() <span class="sc">+</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cumulative total of clients served by program"</span>,</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Data from July 2017 through September 2022"</span>,</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"**Note:** Four records without close dates are omitted."</span>) <span class="sc">+</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_hda</span>() <span class="sc">+</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_zero_line</span>(<span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="piedmont_files/figure-html/cumulative-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>PHA served DPL-only clients from 2017 through 2019, averaging fewer than ten annually. In 2020, PHA began offering SPARC, which has been used by more than 25 clients annually since. Several clients have used both DPL and SPARC assistance each year since 2020.</p>
<div class="cell">
<details>
<summary>View code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarise data by program and year</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>clients_annual <span class="ot">&lt;-</span> clients_total <span class="sc">|&gt;</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(close_date) <span class="sc">|&gt;</span>     </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(program, <span class="at">year =</span> <span class="fu">floor_date</span>(close_date, <span class="st">"year"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(program, year, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="dv">0</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">format</span>(year, <span class="st">"%Y"</span>))</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(clients_annual, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> n, <span class="at">fill =</span> program)) <span class="sc">+</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_hda</span>() <span class="sc">+</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Annual number of clients served by program"</span>,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Data from July 2017 through September 2022"</span>,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"**Note:** Four records without close dates are omitted."</span>) <span class="sc">+</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_hda</span>() <span class="sc">+</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_zero_line</span>(<span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="piedmont_files/figure-html/annual-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In total, two-thirds (66 percent) of all clients used SPARC only. About one quarter (27 percent) used DPL only, and just eight clients (6 percent) took advantage of both.</p>
<div class="cell">
<details>
<summary>View code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarise data by program</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>clients_program <span class="ot">&lt;-</span> clients_total <span class="sc">|&gt;</span>     </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(program)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(clients_program, <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">reorder</span>(program, n), <span class="at">x =</span> n, <span class="at">fill =</span> program, <span class="at">label =</span> n)) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">hjust =</span> <span class="dv">2</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_hda</span>() <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total number of clients served by program"</span>,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Data from July 2017 through September 2022"</span>) <span class="sc">+</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_hda</span>() <span class="sc">+</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_zero_line</span>(<span class="st">"x"</span>) <span class="sc">+</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flip_gridlines</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="piedmont_files/figure-html/totals-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="profile-of-clients" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="profile-of-clients"><span class="header-section-number">3.2</span> Profile of clients</h2>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Race and ethnicity data is only available for clients who used the DPL program.</p>
</div>
</div>
<p>Among the 44 clients who used the DPL program, most were white (41 percent) or Black (34 percent). Another 11 percent were Asian, with the remainder being multiracial or of another race. This is a more diverse pattern than Charlottesville as a whole, where 65 percent of residents are white, while only 15 percent of residents are Black, and 9 percent are Asian.</p>
<p>The share of DPL clients who are Hispanic or Latino is about 7 percent, which aligns very closely with the overall population of Charlottesville.</p>
<div class="cell">
<details>
<summary>View code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarise clients by race</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>clients_race <span class="ot">&lt;-</span> clients_all <span class="sc">|&gt;</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(race) <span class="sc">|&gt;</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add percent column</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">|&gt;</span> </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add source and category columns</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">"Clients"</span>,</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">category =</span> <span class="st">"Race"</span>,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update race labels and column names to match ACS data</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race =</span> <span class="fu">case_when</span>(</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    race <span class="sc">==</span> <span class="st">"Black and White"</span> <span class="sc">~</span> <span class="st">"Multiracial"</span>,</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    race <span class="sc">==</span> <span class="st">"Other races"</span> <span class="sc">~</span> <span class="st">"Another race"</span>,</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> race)) <span class="sc">|&gt;</span> </span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">label =</span> race,</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">value =</span> n)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Same as above for ethnicity</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>clients_ethnicity <span class="ot">&lt;-</span> clients_all <span class="sc">|&gt;</span> </span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(ethnicity) <span class="sc">|&gt;</span> </span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add percent column</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">|&gt;</span> </span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add source and category columns</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">"Clients"</span>,</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">category =</span> <span class="st">"Ethnicity"</span>,</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update race labels and column names to match ACS data</span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ethnicity =</span> <span class="fu">case_when</span>(</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>    ethnicity <span class="sc">==</span> <span class="st">"Hispanic"</span> <span class="sc">~</span> <span class="st">"Hispanic or Latino"</span>,</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>    ethnicity <span class="sc">==</span> <span class="st">"Not Hispanic"</span> <span class="sc">~</span> <span class="st">"Not Hispanic or Latino"</span>,</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> ethnicity)) <span class="sc">|&gt;</span> </span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">label =</span> ethnicity,</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">value =</span> n)</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Add client data to ACS data</span></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>race_join <span class="ot">&lt;-</span> cv_race <span class="sc">|&gt;</span> </span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">"Charlottesville"</span>, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(clients_race, clients_ethnicity)</span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>race_plot <span class="ot">&lt;-</span> race_join <span class="sc">|&gt;</span> </span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">"Race"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pct, <span class="at">y =</span> source, <span class="at">fill =</span> <span class="fu">reorder</span>(label, pct), <span class="at">alpha =</span> source)) <span class="sc">+</span></span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hda</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_alpha_discrete</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Client race and ethnicity compared to Charlottesville"</span>,</span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"Includes only DPL clients"</span>,</span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">"Race"</span>) <span class="sc">+</span></span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_hda</span>() <span class="sc">+</span></span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">flip_gridlines</span>() <span class="sc">+</span></span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"left"</span>,</span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.justification =</span> <span class="st">"left"</span>,</span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a>ethnicity_plot <span class="ot">&lt;-</span> race_join <span class="sc">|&gt;</span> </span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">"Ethnicity"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pct, <span class="at">y =</span> source, <span class="at">fill =</span> <span class="fu">reorder</span>(label, pct), <span class="at">alpha =</span> source)) <span class="sc">+</span></span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hda</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_alpha_discrete</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-87"><a href="#cb19-87" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb19-88"><a href="#cb19-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Ethnicity"</span>,</span>
<span id="cb19-89"><a href="#cb19-89" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"**Source:** U.S. Census Bureau, 2020 Decennial Census P.L. 94-171 Redistricting Data."</span>) <span class="sc">+</span></span>
<span id="cb19-90"><a href="#cb19-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_hda</span>() <span class="sc">+</span></span>
<span id="cb19-91"><a href="#cb19-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">flip_gridlines</span>() <span class="sc">+</span></span>
<span id="cb19-92"><a href="#cb19-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb19-93"><a href="#cb19-93" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"left"</span>,</span>
<span id="cb19-94"><a href="#cb19-94" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.justification =</span> <span class="st">"left"</span>,</span>
<span id="cb19-95"><a href="#cb19-95" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb19-96"><a href="#cb19-96" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-97"><a href="#cb19-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-98"><a href="#cb19-98" aria-hidden="true" tabindex="-1"></a>race_plot <span class="sc">+</span> ethnicity_plot <span class="sc">+</span></span>
<span id="cb19-99"><a href="#cb19-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="piedmont_files/figure-html/race-ethnicity-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Household incomes are available for 88 of the 131 clients. Of the 43 clients with no income data, all are SPARC-only records. Six of the eight DPL clients who also used SPARC have two incomes recorded for each program—these values all differ, sometimes significantly.</p>
<div class="cell">
<details>
<summary>View code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarise clients by household income</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>clients_inc <span class="ot">&lt;-</span> clients_all <span class="sc">|&gt;</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select only id_pha, program, and income columns</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>) <span class="sc">|&gt;</span> </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine DLP and SPARC incomes into one column</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">income =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(household_annual_income_dpl) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(household_annual_income_spc) <span class="sc">~</span> household_annual_income_dpl,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(household_annual_income_dpl) <span class="sc">&amp;</span> <span class="fu">is.na</span>(household_annual_income_spc) <span class="sc">~</span> household_annual_income_dpl,</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(household_annual_income_dpl) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(household_annual_income_spc) <span class="sc">~</span> household_annual_income_spc,</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add column describing income data availability</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(household_annual_income_dpl) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(household_annual_income_spc) <span class="sc">~</span> <span class="st">"Different incomes recorded"</span>,</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(household_annual_income_dpl) <span class="sc">&amp;</span> <span class="fu">is.na</span>(household_annual_income_spc) <span class="sc">~</span> <span class="st">"Income recorded"</span>,</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(household_annual_income_dpl) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(household_annual_income_spc) <span class="sc">~</span> <span class="st">"Income recorded"</span>,</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"No data"</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  )) </span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot showing income data availability</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>clients_inc <span class="sc">|&gt;</span> </span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(program, data) <span class="sc">|&gt;</span> </span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(program, n, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), <span class="at">y =</span> n, <span class="at">fill =</span> data)) <span class="sc">+</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_hda</span>() <span class="sc">+</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Client income data availability by program"</span>,</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"Data from July 2017 through September 2022"</span>) <span class="sc">+</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_hda</span>() <span class="sc">+</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_zero_line</span>(<span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"top"</span></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="piedmont_files/figure-html/income-data-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Most of PHA’s clients have household incomes between $25,000 and $60,000. However, the incomes of SPARC-only clients skew slightly higher, with some above $75,000.</p>
<div class="cell">
<details>
<summary>View code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarise income by program</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(clients_inc, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> program, <span class="at">fill =</span> program)) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(<span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_hda</span>() <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>()) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Client household income by program"</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Data from July 2017 through September 2022"</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"**Note:** Does not include 43 SPARC clients with no recorded income."</span>) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_hda</span>() <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flip_gridlines</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="piedmont_files/figure-html/income-plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Area median incomes (AMI) are calculated only for clients who used the DPL program. AMIs are most commonly between 50 and 80 percent, in line with program eligibility guidelines. On average, AMIs of the DPL clients who also used SPARC are slightly lower than those of clients who used DPL only.</p>
<div class="cell">
<details>
<summary>View code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarise AMI by program</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>clients_inc <span class="sc">|&gt;</span> <span class="fu">filter</span>(program <span class="sc">!=</span> <span class="st">"SPARC"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> client_ami, <span class="at">y =</span> program, <span class="at">fill =</span> program)) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(<span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_hda</span>() <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_percent</span>(), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Client AMI by program"</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Data from July 2017 through September 2022"</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"**Note:** Does not include 43 SPARC clients with no recorded income."</span>) <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_hda</span>() <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flip_gridlines</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="piedmont_files/figure-html/ami-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Compared to the distribution of household incomes in Charlottesville, clients are much more likely to earn more than most renters, while still making significantly less than most homeowners. Over 78 percent of clients earn between $35,000 and $75,000, versus just 27 percent of renters and 20 percent of homeowners.</p>
<div class="cell">
<details>
<summary>View code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign client incomes to ACS categories</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>clients_inc_sum <span class="ot">&lt;-</span> clients_inc <span class="sc">|&gt;</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">income =</span> <span class="fu">case_when</span>(</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    income <span class="sc">&lt;</span> <span class="dv">35000</span> <span class="sc">~</span> <span class="st">"Less than $35,000"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    income <span class="sc">&gt;=</span> <span class="dv">35000</span> <span class="sc">&amp;</span> income <span class="sc">&lt;</span> <span class="dv">50000</span>  <span class="sc">~</span> <span class="st">"$35,000 to $49,999"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    income <span class="sc">&gt;=</span> <span class="dv">50000</span> <span class="sc">&amp;</span> income <span class="sc">&lt;</span> <span class="dv">75000</span>  <span class="sc">~</span> <span class="st">"$50,000 to $74,999"</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    income <span class="sc">&gt;=</span> <span class="dv">75000</span> <span class="sc">&amp;</span> income <span class="sc">&lt;</span> <span class="dv">100000</span>  <span class="sc">~</span> <span class="st">"$75,000 to $99,999"</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    income <span class="sc">&gt;=</span> <span class="dv">100000</span> <span class="sc">~</span> <span class="st">"$100,000 or more"</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"No data"</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter out clients with no income data (optional)</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(income <span class="sc">!=</span> <span class="st">"No data"</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Summarise clients by category</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(income) <span class="sc">|&gt;</span> </span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get column names to match ACS data</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tenure =</span> <span class="st">"Clients"</span>, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">estimate =</span> n)</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Join ACS income data with client income data</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>clients_cv_inc <span class="ot">&lt;-</span> clients_inc_sum <span class="sc">|&gt;</span> </span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(cv_income) <span class="sc">|&gt;</span> </span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add percentages</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tenure) <span class="sc">|&gt;</span> </span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct =</span> estimate<span class="sc">/</span><span class="fu">sum</span>(estimate)) <span class="sc">|&gt;</span> </span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reorder income categories</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">income =</span> <span class="fu">fct_relevel</span>(</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>    income, <span class="st">"Less than $35,000"</span>, <span class="st">"$35,000 to $49,999"</span>, <span class="st">"$50,000 to $74,999"</span>,</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$75,000 to $99,999"</span>, <span class="st">"$100,000 or more"</span>))</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(clients_cv_inc, <span class="fu">aes</span>(<span class="at">y =</span> pct, <span class="at">x =</span> tenure, <span class="at">fill =</span> tenure)) <span class="sc">+</span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>income, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">labeller =</span> <span class="fu">label_wrap_gen</span>(<span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_hda</span>() <span class="sc">+</span></span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Client income compared to Charlottesville"</span>,</span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Data from July 2017 through September 2022"</span>,</span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"**Source:** U.S. Census Bureau, American Community Survey, 2017-2021 5-year estimates. Table B25118.&lt;br&gt;**Note:** Does not include 43 records where client income data not available."</span>) <span class="sc">+</span></span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_hda</span>() <span class="sc">+</span></span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_zero_line</span>(<span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="piedmont_files/figure-html/income-compare-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="assistance-levels" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="assistance-levels"><span class="header-section-number">3.3</span> Assistance levels</h2>
<p>PHA’s DPL program uses funds from a number of different sources. Clients were most commonly supported by HOME funds from DHCD (18) and from Albemarle County’s Homebuyer Assistance Program (11). Overall, PHA has used eight separate sources to fund its DPL program.</p>
<div class="cell">
<details>
<summary>View code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>dpl_sources <span class="ot">&lt;-</span> clients_all <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(program <span class="sc">!=</span> <span class="st">"SPARC"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">36</span><span class="sc">:</span><span class="dv">43</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">10</span>),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"source"</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"x"</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source) <span class="sc">|&gt;</span> </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">sum</span>(x)) <span class="sc">|&gt;</span> </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="fu">case_when</span>(</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    source <span class="sc">==</span> <span class="st">"dhcd"</span> <span class="sc">~</span> <span class="st">"DHCD HOME"</span>,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    source <span class="sc">==</span> <span class="st">"achap"</span> <span class="sc">~</span> <span class="st">"Albemarle County HAP"</span>,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    source <span class="sc">==</span> <span class="st">"cdfi"</span> <span class="sc">~</span> <span class="st">"CDFI Regional Down-payment Loan Program"</span>,</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    source <span class="sc">==</span> <span class="st">"recycled_home"</span> <span class="sc">~</span> <span class="st">"Recycled HOME"</span>,</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    source <span class="sc">==</span> <span class="st">"cahf"</span> <span class="sc">~</span> <span class="st">"Charlottesville Affordable Housing Fund"</span>,</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    source <span class="sc">==</span> <span class="st">"city"</span> <span class="sc">~</span> <span class="st">"Charlottesville HOME"</span>,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    source <span class="sc">==</span> <span class="st">"pha_regional"</span> <span class="sc">~</span> <span class="st">"PHA Regional Homeownership Fund"</span>,</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    source <span class="sc">==</span> <span class="st">"lchap"</span> <span class="sc">~</span> <span class="st">"Louisa County HAP"</span>,</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">str_to_upper</span>(source)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="fu">str_wrap</span>(source, <span class="dv">20</span>))</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dpl_sources, <span class="fu">aes</span>(<span class="at">x =</span> count, <span class="at">y =</span> <span class="fu">reorder</span>(source, count), <span class="at">label =</span> count)) <span class="sc">+</span> </span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"#445ca9"</span>) <span class="sc">+</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">color =</span> <span class="st">"#FFFFFF"</span>, <span class="at">nudge_x =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_hda</span>() <span class="sc">+</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flip_gridlines</span>() <span class="sc">+</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_zero_line</span>(<span class="st">"x"</span>) <span class="sc">+</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Number of DPL awards by source"</span>,</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Data from July 2017 through September 2022"</span>,</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"**Notes:** 'HAP' = Homebuyer Assistance Program."</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="piedmont_files/figure-html/dpl-sources-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>PHA awarded a total of $1,242,190 in DPL assistance from July 2017 to September 2022. This amounted to roughly $28,230 provided per client.</p>
<div class="cell">
<details>
<summary>View code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>dpl_amount <span class="ot">&lt;-</span> clients_all <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(<span class="st">"close_date_dpl"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(close_date_dpl) <span class="sc">|&gt;</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cum_sum =</span> <span class="fu">cumsum</span>(pha_loans_amount))</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dpl_amount, <span class="fu">aes</span>(<span class="at">x =</span> close_date_dpl, <span class="at">y =</span> cum_sum)) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="st">"#445ca9"</span>) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>(<span class="at">scale =</span> <span class="fl">0.001</span>, <span class="at">suffix =</span> <span class="st">"k"</span>)) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_zero_line</span>(<span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_hda</span>() <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Total amount of DPL assistance awarded"</span>,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Data from July 2017 through September 2022"</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="piedmont_files/figure-html/dpl-amount-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The average amount each client received stayed around $28,000 from 2017 through 2020. In 2021, that average increased to $37,435. In 2022, the two clients that received DPL each received significant DPL assistance well above prior year averages.</p>
<div class="cell">
<details>
<summary>View code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>dpl_annual <span class="ot">&lt;-</span> dpl_amount <span class="sc">|&gt;</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">format</span>(close_date_dpl, <span class="at">format =</span> <span class="st">"%Y"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pha_loans_amount <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg =</span> <span class="fu">mean</span>(pha_loans_amount),</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">clients =</span> <span class="fu">n</span>())</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dpl_annual, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> avg, <span class="at">label =</span> clients)) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"#445ca9"</span>) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">vjust =</span> <span class="dv">2</span>,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>(<span class="at">scale =</span> <span class="fl">0.001</span>, <span class="at">suffix =</span> <span class="st">"k"</span>),</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">10000</span>, <span class="dv">20000</span>, <span class="dv">30000</span>, <span class="dv">40000</span>, <span class="dv">50000</span>)) <span class="sc">+</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_zero_line</span>(<span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_hda</span>() <span class="sc">+</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average amount of DPL assistance awarded per client"</span>,</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Data from July 2017 through September 2022"</span>,</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"**Note:** Bars show total number of clients for that group."</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="piedmont_files/figure-html/dpl-annual-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Black clients were the only race with an average DPL amount ($20,761) below the overall average. Asian, Black and White, and White-alone clients all had averages between $32,000 and $34,000. Three clients of another race tallied a notably higher average at $42,973.</p>
<div class="cell">
<details>
<summary>View code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>dpl_race <span class="ot">&lt;-</span> dpl_amount <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pha_loans_amount <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race) <span class="sc">|&gt;</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg =</span> <span class="fu">mean</span>(pha_loans_amount),</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">clients =</span> <span class="fu">n</span>())</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dpl_race, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(race, avg), <span class="at">y =</span> avg, <span class="at">fill =</span> race, <span class="at">label =</span> clients)) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">vjust =</span> <span class="dv">2</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_hda</span>() <span class="sc">+</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>(<span class="at">scale =</span> <span class="fl">0.001</span>, <span class="at">suffix =</span> <span class="st">"k"</span>),</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">10000</span>, <span class="dv">20000</span>, <span class="dv">30000</span>, <span class="dv">40000</span>, <span class="dv">50000</span>)) <span class="sc">+</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_zero_line</span>(<span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_hda</span>() <span class="sc">+</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average amount of DPL assistance awarded by race"</span>,</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Data from July 2017 through September 2022"</span>,</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"**Note:** Bars show total number of clients for that group."</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="piedmont_files/figure-html/dpl-race-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Only five total clients were Hispanic or chose not to respond when asked their ethnicity. As a result, the average DPL amount for non-Hispanic clients ($29,310) is very close to the overall client average. Among the three clients who were Hispanic, their average DPL amounted to a much larger $42,316.</p>
<div class="cell">
<details>
<summary>View code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>dpl_ethnicity <span class="ot">&lt;-</span> dpl_amount <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pha_loans_amount <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ethnicity) <span class="sc">|&gt;</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg =</span> <span class="fu">mean</span>(pha_loans_amount),</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">clients =</span> <span class="fu">n</span>())</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dpl_ethnicity, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(ethnicity, avg), <span class="at">y =</span> avg, <span class="at">fill =</span> ethnicity, <span class="at">label =</span> clients)) <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">vjust =</span> <span class="dv">2</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_hda</span>() <span class="sc">+</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>(<span class="at">scale =</span> <span class="fl">0.001</span>, <span class="at">suffix =</span> <span class="st">"k"</span>),</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">10000</span>, <span class="dv">20000</span>, <span class="dv">30000</span>, <span class="dv">40000</span>, <span class="dv">50000</span>)) <span class="sc">+</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_zero_line</span>(<span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_hda</span>() <span class="sc">+</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average amount of DPL assistance awarded by ethnicity"</span>,</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Data from July 2017 through September 2022"</span>,</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"**Note:** Bars show total number of clients for that group."</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="piedmont_files/figure-html/dpl-ethnicity-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="spatial-patterns" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="spatial-patterns"><span class="header-section-number">3.4</span> Spatial patterns</h2>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Client and property location data is only available for clients who used the DPL program.</p>
</div>
</div>
<div class="cell">
<details>
<summary>Geocode addresses</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get list of all localities in Virginia</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>va_localities <span class="ot">&lt;-</span> <span class="fu">list_counties</span>(<span class="st">"VA"</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Get all census tracts for Virginia</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>va_tracts <span class="ot">&lt;-</span> <span class="fu">tracts</span>(<span class="at">state =</span> <span class="st">"VA"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(va_localities, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"COUNTYFP"</span> <span class="ot">=</span> <span class="st">"county_code"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="dv">4502</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Geocode client addresses</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>clients_geocode <span class="ot">&lt;-</span> clients_all <span class="sc">|&gt;</span> </span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geocode</span>(<span class="at">street =</span> client_street_address, <span class="at">state =</span> client_state,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">city =</span> client_city, <span class="at">postalcode =</span> client_zip,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">method =</span> <span class="st">"geocodio"</span>,</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">lat =</span> lat,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">long =</span> long) <span class="sc">|&gt;</span> </span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Drop SPARC entries with no address data</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(lat) <span class="sc">|&gt;</span> </span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Specify WGS 1984 coordinate system for lat/long data</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"long"</span>, <span class="st">"lat"</span>),</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">remove =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Project into Virginia State Plane South</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="dv">4502</span>)</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Spatial join client data with tracts and localities</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>clients_sf <span class="ot">&lt;-</span> <span class="fu">st_join</span>(clients_geocode, va_tracts) <span class="sc">|&gt;</span> </span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Locality =</span> county)</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Geocode property addresses</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>property_geocode <span class="ot">&lt;-</span> clients_all <span class="sc">|&gt;</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geocode</span>(<span class="at">street =</span> property_street_address, <span class="at">state =</span> property_state,</span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>          <span class="at">city =</span> property_city, <span class="at">postalcode =</span> property_zip,</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>          <span class="at">method =</span> <span class="st">"geocodio"</span>,</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>          <span class="at">lat =</span> lat,</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>          <span class="at">long =</span> long) <span class="sc">|&gt;</span> </span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Drop SPARC entries with no address data</span></span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(lat) <span class="sc">|&gt;</span> </span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Specify WGS 1984 coordinate system for lat/long data</span></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"long"</span>, <span class="st">"lat"</span>),</span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>           <span class="at">remove =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>           <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Project into Virginia State Plane South</span></span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="dv">4502</span>)</span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Spatial join client data with tracts and localities</span></span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a>property_sf <span class="ot">&lt;-</span> <span class="fu">st_join</span>(property_geocode, va_tracts) <span class="sc">|&gt;</span> </span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Locality =</span> county)</span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Save data</span></span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(clients_sf, <span class="st">"data/clients_sf.rds"</span>)</span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(property_sf, <span class="st">"data/property_sf.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="client-origins" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="client-origins"><span class="header-section-number">3.4.1</span> Client origins</h3>
<p>The map below shows the original addresses of each client, i.e.&nbsp;where they lived when they applied for DPL assistance.</p>
<div class="cell">
<details>
<summary>Client map</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make map of clients</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>clients_sf <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/clients_sf.rds"</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mapview</span>(</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  clients_sf,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">zcol =</span> <span class="st">"Locality"</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">layer.name =</span> <span class="st">"Client locality"</span>,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="cn">FALSE</span>,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">popup =</span> <span class="cn">FALSE</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-364f706872844de84581" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-364f706872844de84581">{"x":{"options":{"minZoom":1,"maxZoom":52,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron","CartoDB.Positron","CartoDB.Positron",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["CartoDB.DarkMatter","CartoDB.DarkMatter","CartoDB.DarkMatter",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap","OpenStreetMap","OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenTopoMap","OpenTopoMap","OpenTopoMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["point",440]},{"method":"addCircleMarkers","args":[[37.945121,38.130402,38.628341,38.133835,37.445296,38.071919,38.034247,38.039836,38.006672,38.130228,38.076385,38.026897,38.06458,38.039511,38.001605,38.028065,38.022894,38.024258,38.06265,38.072198,38.026588,38.022415,38.091416,37.774706,38.072255,38.026903,38.043328,38.016887,38.042903,37.768349,38.06751,37.897807,38.021189,38.070786,38.048325,38.015476,38.071201,37.976487,38.080808,38.070379,38.006993,38.023142,38.037327,38.040276],[-78.637459,-78.445777,-77.274894,-78.188898,-79.173736,-78.492282,-78.493561,-78.457918,-78.52354,-78.445959,-78.484233,-78.481312,-78.494677,-78.488945,-78.485515,-78.481048,-78.485742,-78.510657,-78.506595,-78.491978,-78.48045,-78.495185,-78.476396,-78.151634,-78.491141,-78.454841,-78.517808,-78.502008,-78.516989,-78.325173,-78.49779,-78.302091,-78.497694,-78.490828,-78.463376,-78.502194,-78.491875,-78.225091,-78.488874,-78.49359,-78.526196,-78.494221,-78.445721,-78.483814],6,null,"Client locality",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"point","stroke":true,"color":"#333333","weight":1,"opacity":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9],"fill":true,"fillColor":["#4B0055","#4B0055","#FDE333","#96D84B","#00BE7D","#4B0055","#353E7C","#353E7C","#4B0055","#4B0055","#4B0055","#353E7C","#353E7C","#353E7C","#4B0055","#353E7C","#353E7C","#353E7C","#4B0055","#4B0055","#353E7C","#353E7C","#4B0055","#007094","#4B0055","#353E7C","#4B0055","#353E7C","#4B0055","#007094","#4B0055","#007094","#353E7C","#4B0055","#353E7C","#353E7C","#4B0055","#009B95","#4B0055","#4B0055","#4B0055","#353E7C","#4B0055","#353E7C"],"fillOpacity":[0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6]},null,null,null,{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addHomeButton","args":[-79.173736,37.445296,-77.274894,38.628341,true,"Client locality","Zoom to Client locality","<strong> Client locality <\/strong>","bottomright"]},{"method":"addLayersControl","args":[["CartoDB.Positron","CartoDB.DarkMatter","OpenStreetMap","Esri.WorldImagery","OpenTopoMap"],"Client locality",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addLegend","args":[{"colors":["#4B0055","#353E7C","#007094","#009B95","#00BE7D","#96D84B","#FDE333"],"labels":["Albemarle","Charlottesville city","Fluvanna","Louisa","Lynchburg city","Orange","Prince William"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"Client locality","extra":null,"layerId":null,"className":"info legend","group":"Client locality"}]}],"limits":{"lat":[37.445296,38.628341],"lng":[-79.173736,-77.274894]},"fitBounds":[37.445296,-79.173736,38.628341,-77.274894,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
</div>
</div>
<p><br> Most clients lived in either Albemarle (20) or Charlottesville (17) when they applied to the DPL program. Three clients also came from Fluvanna, while all other origin localities has one client each.</p>
<div class="cell">
<details>
<summary>View code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>clients_locality <span class="ot">&lt;-</span> clients_sf <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Locality)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(clients_locality, <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> <span class="fu">reorder</span>(Locality, n), <span class="at">label =</span> n)) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"#445ca9"</span>) <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">color =</span> <span class="st">"#FFFFFF"</span>, <span class="at">nudge_x =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_hda</span>() <span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flip_gridlines</span>() <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_zero_line</span>(<span class="st">"x"</span>) <span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Number of clients by locality of origin"</span>,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Data from July 2017 through September 2022"</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="piedmont_files/figure-html/clients-locality-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="client-destinations" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="client-destinations"><span class="header-section-number">3.4.2</span> Client destinations</h3>
<p>The map below shows the addresses of homes purchased by clients, i.e.&nbsp;where they moved after using the DPL program.</p>
<div class="cell">
<details>
<summary>Property map</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make map of properties</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>property_sf <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/property_sf.rds"</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mapview</span>(</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  property_sf,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">zcol =</span> <span class="st">"Locality"</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">layer.name =</span> <span class="st">"Property locality"</span>,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="cn">FALSE</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">popup =</span> <span class="cn">FALSE</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-7a919291568c54b55936" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-7a919291568c54b55936">{"x":{"options":{"minZoom":1,"maxZoom":52,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron","CartoDB.Positron","CartoDB.Positron",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["CartoDB.DarkMatter","CartoDB.DarkMatter","CartoDB.DarkMatter",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap","OpenStreetMap","OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenTopoMap","OpenTopoMap","OpenTopoMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["point",440]},{"method":"addCircleMarkers","args":[[38.069472,38.063692,38.588216,37.960895,38.026588,38.078619,38.078137,37.922772,37.924717,38.164545,37.900011,38.007949,38.132523,38.039511,38.076849,38.021578,38.165783,38.23527,38.212897,38.0716,38.017421,38.0175,38.166067,37.920213,38.029081,38.026903,37.900373,38.016887,38.05654,37.892251,38.069185,37.941748,38.164932,38.163056,38.024508,37.899889,38.071201,37.915488,38.079144,38.063075,38.067956,38.02112,38.077982,38.023323],[-78.666502,-78.509837,-77.298927,-77.966698,-78.48045,-78.488663,-78.48822,-78.321715,-78.346443,-78.418525,-78.311149,-78.523119,-78.44304,-78.488945,-78.487148,-78.494599,-78.417674,-78.362277,-78.401987,-78.500588,-78.467864,-78.467845,-78.41788,-78.320728,-78.459849,-78.454841,-78.310715,-78.502008,-78.464521,-78.313687,-78.468913,-78.174824,-78.420241,-78.420982,-78.494859,-78.311246,-78.491875,-78.059248,-78.484477,-78.496865,-78.494375,-78.498505,-78.49138,-78.496814],6,null,"Property locality",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"point","stroke":true,"color":"#333333","weight":1,"opacity":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9],"fill":true,"fillColor":["#4B0055","#4B0055","#FDE333","#7ED357","#274983","#4B0055","#4B0055","#008298","#008298","#4B0055","#008298","#4B0055","#4B0055","#274983","#4B0055","#274983","#4B0055","#00B28A","#00B28A","#4B0055","#4B0055","#4B0055","#4B0055","#008298","#4B0055","#274983","#008298","#274983","#4B0055","#008298","#4B0055","#008298","#4B0055","#4B0055","#274983","#008298","#4B0055","#7ED357","#4B0055","#274983","#4B0055","#274983","#4B0055","#274983"],"fillOpacity":[0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6]},null,null,null,{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addHomeButton","args":[-78.666502,37.892251,-77.298927,38.588216,true,"Property locality","Zoom to Property locality","<strong> Property locality <\/strong>","bottomright"]},{"method":"addLayersControl","args":[["CartoDB.Positron","CartoDB.DarkMatter","OpenStreetMap","Esri.WorldImagery","OpenTopoMap"],"Property locality",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addLegend","args":[{"colors":["#4B0055","#274983","#008298","#00B28A","#7ED357","#FDE333"],"labels":["Albemarle","Charlottesville city","Fluvanna","Greene","Louisa","Prince William"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"Property locality","extra":null,"layerId":null,"className":"info legend","group":"Property locality"}]}],"limits":{"lat":[37.892251,38.588216],"lng":[-78.666502,-77.298927]},"fitBounds":[37.892251,-78.666502,38.588216,-77.298927,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
</div>
</div>
<p><br> The majority of homes purchased by clients were in Albemarle (22), followed by Charlottesville (9) and Fluvanna (8). Two or fewer clients purchased homes in each of the other localities.</p>
<div class="cell">
<details>
<summary>View code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>property_locality <span class="ot">&lt;-</span> property_sf <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Locality)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(property_locality, <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> <span class="fu">reorder</span>(Locality, n), <span class="at">label =</span> n)) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"#445ca9"</span>) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">color =</span> <span class="st">"#FFFFFF"</span>, <span class="at">nudge_x =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_hda</span>() <span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flip_gridlines</span>() <span class="sc">+</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_zero_line</span>(<span class="st">"x"</span>) <span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Number of clients by destination locality"</span>,</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Data from July 2017 through September 2022"</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="piedmont_files/figure-html/property-locality-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="client-moves" class="level3" data-number="3.4.3">
<h3 data-number="3.4.3" class="anchored" data-anchor-id="client-moves"><span class="header-section-number">3.4.3</span> Client moves</h3>
<p>Most of PHA’s DPL clients moved from, moved to, or stayed in Albemarle County or the City of Charlottesville. A similar number of clients were originally from Albemarle (20) and Charlottesville (17), with only seven from elsewhere. Albemarle was the most common destination (22), followed by Charlottesville (9), and Fluvanna (8).</p>
<div class="cell">
<details>
<summary>View code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggsankey)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>client_moves <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(clients_sf) <span class="sc">|&gt;</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">st_drop_geometry</span>(property_sf), <span class="st">"id_pha"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"Origin"</span> <span class="ot">=</span> <span class="st">'Locality.x'</span>, <span class="st">"Destination"</span> <span class="ot">=</span> <span class="st">'Locality.y'</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>client_sankey <span class="ot">&lt;-</span> client_moves <span class="sc">|&gt;</span> </span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_long</span>(Origin, Destination)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(client_sankey, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">next_x =</span> next_x,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">node =</span> node, <span class="at">next_node =</span> next_node,</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fill =</span> node, <span class="at">label =</span> node)) <span class="sc">+</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sankey</span>(<span class="at">flow_alpha =</span> <span class="fl">0.75</span>, <span class="at">smooth =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sankey_label</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="st">"#383c3d"</span>) <span class="sc">+</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_hda</span>(<span class="at">repeat_pal =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>), <span class="at">position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_hda</span>() <span class="sc">+</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Origin and destination of DPL clients"</span>,</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Data from July 2017 through September 2022"</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="piedmont_files/figure-html/client-moves-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Among all clients from Albemarle, most stayed in the county, or to another county. Only one moved into Charlottesville. Just seven of the 17 clients from Charlottesville stayed in the city; the same number moved into Albemarle and the remainder to other counties.</p>
<div class="cell">
<details>
<summary>View code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>client_moves_sum <span class="ot">&lt;-</span> client_moves <span class="sc">|&gt;</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">move =</span> <span class="fu">case_when</span>(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    Origin <span class="sc">==</span> Destination <span class="sc">~</span> <span class="st">"Stayed"</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Moved"</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">origin_sum =</span> <span class="fu">case_when</span>(</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    Origin <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Fluvanna"</span>, <span class="st">"Louisa"</span>, <span class="st">"Lynchburg city"</span>, <span class="st">"Orange"</span>, <span class="st">"Prince William"</span>) <span class="sc">~</span> <span class="st">"From somewhere else"</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">str_c</span>(<span class="st">"From "</span>, Origin)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">destination_sum =</span> <span class="fu">case_when</span>(</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    Destination <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Fluvanna"</span>, <span class="st">"Louisa"</span>, <span class="st">"Greene"</span>, <span class="st">"Prince William"</span>) <span class="sc">~</span> <span class="st">"Somewhere else"</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> Destination</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(client_moves_sum, <span class="fu">aes</span>(<span class="at">x =</span> destination_sum, <span class="at">fill =</span> destination_sum)) <span class="sc">+</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>origin_sum) <span class="sc">+</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_hda</span>() <span class="sc">+</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_hda</span>() <span class="sc">+</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_zero_line</span>(<span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(),</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Number of clients by origin and destination"</span>,</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Data from July 2017 through September 2022"</span>,</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Destination"</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="piedmont_files/figure-html/client-moves-sum-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="housing-outcomes" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="housing-outcomes"><span class="header-section-number">3.5</span> Housing outcomes</h2>
<p>The median sales price for all clients was $224,500, but those prices vary significantly by program.</p>
<div class="cell">
<details>
<summary>View code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarise home sales price by program</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>clients_inc_price <span class="ot">&lt;-</span> clients_all <span class="sc">|&gt;</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select only id_pha, program, income, home sales price, and race columns</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">21</span>, <span class="dv">53</span>) <span class="sc">|&gt;</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine DLP and SPARC incomes into one column</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">income =</span> <span class="fu">case_when</span>(</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(household_annual_income_dpl) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(household_annual_income_spc) <span class="sc">~</span> household_annual_income_dpl,</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(household_annual_income_dpl) <span class="sc">&amp;</span> <span class="fu">is.na</span>(household_annual_income_spc) <span class="sc">~</span> household_annual_income_dpl,</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(household_annual_income_dpl) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(household_annual_income_spc) <span class="sc">~</span> household_annual_income_spc,</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine DLP and SPARC sales prices into one column</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">price =</span> <span class="fu">case_when</span>(</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(sale_price_dpl) <span class="sc">~</span> sale_price_dpl,</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> sale_price_spc</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate table</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>clients_inc_price <span class="sc">|&gt;</span> </span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(price) <span class="sc">|&gt;</span> </span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(program) <span class="sc">|&gt;</span> </span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">median =</span> <span class="fu">median</span>(price),</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean =</span> <span class="fu">mean</span>(price)) <span class="sc">|&gt;</span> </span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="sc">~</span> formattable<span class="sc">::</span><span class="fu">currency</span>(.x, <span class="at">digits =</span> <span class="dv">0</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(median)) <span class="sc">|&gt;</span> </span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Program"</span>, <span class="st">"Clients"</span>, <span class="st">"Median sales price"</span>, <span class="st">"Mean sales price"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>)</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> Program </th>
   <th style="text-align:right;"> Clients </th>
   <th style="text-align:right;"> Median sales price </th>
   <th style="text-align:right;"> Mean sales price </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Both </td>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> $254,050 </td>
   <td style="text-align:right;"> $241,363 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> SPARC </td>
   <td style="text-align:right;"> 86 </td>
   <td style="text-align:right;"> $228,800 </td>
   <td style="text-align:right;"> $226,923 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> DPL </td>
   <td style="text-align:right;"> 36 </td>
   <td style="text-align:right;"> $184,753 </td>
   <td style="text-align:right;"> $200,497 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Home prices were lowest for DPL-only clients, with most between $150,000 and $200,000. SPARC-only clients purchased homes generally between $200,000 and $250,000. Clients who used both programs were able to purchase homes at higher prices, on average, than all other clients.</p>
<div class="cell">
<details>
<summary>View code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(clients_inc_price, <span class="fu">aes</span>(<span class="at">x =</span> price, <span class="at">y =</span> program, <span class="at">fill =</span> program)) <span class="sc">+</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(<span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_hda</span>() <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>(),</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">75000</span>, <span class="dv">350000</span>),</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">100000</span>, <span class="dv">150000</span>, <span class="dv">200000</span>, <span class="dv">250000</span>, <span class="dv">300000</span>)) <span class="sc">+</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Client home purchase price by program"</span>,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Data from July 2017 through September 2022"</span>) <span class="sc">+</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_hda</span>() <span class="sc">+</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flip_gridlines</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="piedmont_files/figure-html/price-plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Average home prices also vary by race. Clients identifying as another race have the highest average, surpassing $250,000, although this includes only three buyers. Clients whose records do not include their race also have high average prices around $227,000. These are nearly all SPARC-only clients.</p>
<p>Asian and Black clients have average home prices slightly below the average for all clients, followed by clients who are White or who are White and Black. Those clients have average home prices well below $200,000.</p>
<div class="cell">
<details>
<summary>View code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>clients_price_race <span class="ot">&lt;-</span> clients_inc_price <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(price) <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(race) <span class="sc">|&gt;</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">Mean =</span> <span class="fu">mean</span>(price),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">Median =</span> <span class="fu">median</span>(price)) <span class="sc">|&gt;</span> </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race =</span> <span class="fu">replace_na</span>(race, <span class="st">"No data"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">names_to =</span> <span class="st">"stat"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(clients_price_race, <span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="fu">reorder</span>(race, value),</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> stat,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label =</span> <span class="fu">label_dollar</span>(<span class="at">accuracy =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="fl">0.001</span>, <span class="at">suffix =</span> <span class="st">"k"</span>)(value))) <span class="sc">+</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">hjust =</span> <span class="fl">1.25</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_hda</span>() <span class="sc">+</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>(),</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50000</span>, <span class="dv">100000</span>, <span class="dv">150000</span>, <span class="dv">200000</span>, <span class="dv">250000</span>)) <span class="sc">+</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average client home purchase price by race"</span>,</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Data from July 2017 through September 2022"</span>) <span class="sc">+</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_hda</span>() <span class="sc">+</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flip_gridlines</span>() <span class="sc">+</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_zero_line</span>(<span class="st">"x"</span>) <span class="sc">+</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="piedmont_files/figure-html/price-race-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>…</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Client home attributes and price compared to neighborhood</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Client loan products compared to region (and neighborhood, if possible)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="home-equity" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="home-equity"><span class="header-section-number">3.6</span> Home equity</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Two methods to try and test</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 1:</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find average percent change in assessment values from purchase date to current for all comparable homes in neighborhood</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply percent change to original sales price for estimated home value</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate remaining mortgage balance using loan info</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># value - balance = equity</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 2:</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Same as above but use MLS sales data</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Will have much smaller sample size -- may only be possible at city level</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine if any past clients have already sold home -- would provide most accurate estimate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="takeaways" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Takeaways</h1>
<p><code>Major (and other noteworthy) findings from analysis</code></p>
</section>
<section id="next-steps" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Next steps</h1>
<p>HDAdvisors will continue to work with PHA on the following next steps:</p>
<ul>
<li>Develop consistent data entry/collection procedures to reduce time needed for data cleaning/correction in future analysis.</li>
<li>Collect and analyze program application data for clients who did not receive assistance from DPL and/or SPARC. Assess, if possible, reasons for denial and compare with loan denial trends in HMDA data.</li>
</ul>
<p><code>Plenty more to add here</code></p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>